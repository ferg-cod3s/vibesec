{
  "files": [
    [
      "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
      {
        "hash": "d30475ca1377a5d65f3f7b489fc24c24b2b4f13d",
        "timestamp": 1762722081203
      }
    ],
    [
      "/Users/johnferguson/Github/vibesec/tests/fixtures/syntax-error.js",
      {
        "hash": "1649d0fb56b12d25227d5135a8acd82fc807315b",
        "timestamp": 1762722081850
      }
    ],
    [
      "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/sql-injection.js",
      {
        "hash": "0513f9f8bbeae5054b917374910eb55a3111e5f8",
        "timestamp": 1762722082047
      }
    ],
    [
      "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/command-injection.py",
      {
        "hash": "3a0eaeff9506f9e8e8fca9fa19d1c41f008c947f",
        "timestamp": 1762722082329
      }
    ],
    [
      "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/path-traversal.py",
      {
        "hash": "4aefbea12fd0504f3831517a0b9f97f9e87f5f19",
        "timestamp": 1762722082334
      }
    ],
    [
      "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/incomplete-security.js",
      {
        "hash": "a0c1dade9d68c02d973cd7a57367876e0a20a1a7",
        "timestamp": 1762722082377
      }
    ],
    [
      "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/weak-auth.js",
      {
        "hash": "29da042618d747c2d4ab2dff0b791f6f1abb3224",
        "timestamp": 1762722082395
      }
    ],
    [
      "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/hardcoded-secret.js",
      {
        "hash": "ae85cb3bed1a502b3306fa55ffdad50f5983480e",
        "timestamp": 1762722082463
      }
    ],
    [
      "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/weak-auth.py",
      {
        "hash": "84ea9d568f30e8aafba542343a18de6c680fbcbd",
        "timestamp": 1762722082492
      }
    ],
    [
      "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/error-handler.py",
      {
        "hash": "588de930f745289867e552c7be743438ac6d9b0d",
        "timestamp": 1762722082496
      }
    ],
    [
      "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/command-injection.js",
      {
        "hash": "08dbb906582dcc013f8eca82f2f61817d74e5c8e",
        "timestamp": 1762722082506
      }
    ],
    [
      "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/xss.js",
      {
        "hash": "baf6050143cd2efe5fc67a499add272c78a67e67",
        "timestamp": 1762722082512
      }
    ],
    [
      "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/ai-security.py",
      {
        "hash": "55574b42b74eacf234246d447954c30e0c0a92ee",
        "timestamp": 1762722082544
      }
    ],
    [
      "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/cors.js",
      {
        "hash": "a7fcafe622e7fd422e1aa2be966869193584ca53",
        "timestamp": 1762722082618
      }
    ],
    [
      "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
      {
        "hash": "ef4f97505ed45e9c13a091e4e5751501b170d856",
        "timestamp": 1762722082810
      }
    ],
    [
      "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
      {
        "hash": "3bcccd0c1d2894cabcc876dfc4006a43205c0c21",
        "timestamp": 1762722082829
      }
    ],
    [
      "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/hardcoded-creds.py",
      {
        "hash": "a56c36c2a40865450b4d4874305df405b601f2a6",
        "timestamp": 1762722082868
      }
    ],
    [
      "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/sql-injection.py",
      {
        "hash": "5df22bcde64d854746697c53541dc121a72a85bf",
        "timestamp": 1762722082878
      }
    ],
    [
      "/Users/johnferguson/Github/vibesec/tests/fixtures/large-test.js",
      {
        "hash": "b884c44ba569c830f9cbaedb6a29f7f35cf87673",
        "timestamp": 1762722089647
      }
    ]
  ],
  "rules": [],
  "results": [
    [
      "d30475ca1377a5d65f3f7b489fc24c24b2b4f13d",
      [
        {
          "id": "ast-sql-injection-1762722081023-7f60ogzco",
          "rule": "ast-sql-injection",
          "severity": "critical",
          "category": "injection",
          "title": "SQL Injection Detected",
          "description": "SQL injection vulnerabilities detected in query construction",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
            "line": 27,
            "column": 17
          },
          "snippet": "    25 |     // This is vulnerable - userId flows through multiple transformations\n    26 |     const processedId = this.processUserId(userId);\n→   27 |     const sql = `SELECT * FROM users WHERE id = '${processedId}'`; // SQL injection here\n    28 | \n    29 |     const [rows] = await this.connection.execute(sql);",
          "fix": {
            "recommendation": "Use parameterized queries or prepared statements instead of string concatenation",
            "before": "const sql = `SELECT * FROM users WHERE id = '${processedId}'`; // SQL injection here",
            "after": "",
            "references": [
              "https://owasp.org/www-community/attacks/SQL_Injection",
              "https://cwe.mitre.org/data/definitions/89.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-89",
            "owasp": "A03:2021"
          }
        },
        {
          "id": "ast-sql-injection-1762722081023-vfgr1afu7",
          "rule": "ast-sql-injection",
          "severity": "critical",
          "category": "injection",
          "title": "SQL Injection Detected",
          "description": "SQL injection vulnerabilities detected in query construction",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
            "line": 27,
            "column": 16
          },
          "snippet": "    25 |     // This is vulnerable - userId flows through multiple transformations\n    26 |     const processedId = this.processUserId(userId);\n→   27 |     const sql = `SELECT * FROM users WHERE id = '${processedId}'`; // SQL injection here\n    28 | \n    29 |     const [rows] = await this.connection.execute(sql);",
          "fix": {
            "recommendation": "Use parameterized queries or prepared statements instead of string concatenation",
            "before": "const sql = `SELECT * FROM users WHERE id = '${processedId}'`; // SQL injection here",
            "after": "",
            "references": [
              "https://owasp.org/www-community/attacks/SQL_Injection",
              "https://cwe.mitre.org/data/definitions/89.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-89",
            "owasp": "A03:2021"
          }
        },
        {
          "id": "hardcoded-password-1762722081023-fjplix0d0",
          "rule": "hardcoded-password",
          "severity": "critical",
          "category": "secrets",
          "title": "Hardcoded Password Detected",
          "description": "Passwords should never be hardcoded in source code. Store them securely in environment variables or secure credential stores.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
            "line": 78,
            "column": 2
          },
          "snippet": "    76 |   host: 'localhost',\n    77 |   user: 'root',\n→   78 |   password: 'password',\n    79 |   database: 'myapp',\n    80 | });",
          "fix": {
            "recommendation": "Store passwords in environment variables (e.g., process.env.DB_PASSWORD) or use a secure credential management system",
            "before": "password: 'password',",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "json-csrf-vulnerability-1762722081040-cgk6otrjv",
          "rule": "json-csrf-vulnerability",
          "severity": "medium",
          "category": "web-security",
          "title": "JSON Endpoint Without CSRF Protection",
          "description": "JSON endpoints can still be vulnerable to CSRF attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
            "line": 9,
            "column": 8
          },
          "snippet": "     7 | \n     8 | const app = express();\n→    9 | app.use(express.json());\n    10 | \n    11 | interface User {",
          "fix": {
            "recommendation": "JSON endpoints need CSRF protection too, or validate Origin header.\n\nBefore:\napp.post('/api/transfer', (req, res) => {\n  const amount = req.body.amount;\n});\n\nAfter:\n// Option 1: Use CSRF tokens\napp.post('/api/transfer', csrfProtection, (req, res) => {\n  const amount = req.body.amount;\n});\n\n// Option 2: Validate Origin/Referer headers\napp.use((req, res, next) => {\n  const origin = req.get('origin');\n  if (req.method !== 'GET' && !allowedOrigins.includes(origin)) {\n    return res.status(403).json({ error: 'Forbidden' });\n  }\n  next();\n});\n",
            "before": "app.use(express.json());",
            "after": "",
            "references": [
              "https://owasp.org/www-community/attacks/csrf",
              "https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-352",
            "owasp": "A01:2021"
          }
        },
        {
          "id": "hardcoded-password-1762722081047-y2m1fv6vw",
          "rule": "hardcoded-password",
          "severity": "critical",
          "category": "secrets",
          "title": "Hardcoded Password Detected",
          "description": "Passwords should never be hardcoded in source code. Store them securely in environment variables or secure credential stores.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
            "line": 78,
            "column": 2
          },
          "snippet": "    76 |   host: 'localhost',\n    77 |   user: 'root',\n→   78 |   password: 'password',\n    79 |   database: 'myapp',\n    80 | });",
          "fix": {
            "recommendation": "Store passwords in environment variables (e.g., process.env.DB_PASSWORD) or use a secure credential management system",
            "before": "password: 'password',",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "missing-csp-header-1762722081073-vk1lxgl5d",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
            "line": 9,
            "column": 0
          },
          "snippet": "     7 | \n     8 | const app = express();\n→    9 | app.use(express.json());\n    10 | \n    11 | interface User {",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "app.use(express.json());",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-csp-header-1762722081074-z44lu1sy5",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
            "line": 85,
            "column": 0
          },
          "snippet": "    83 | const userController = new UserController(dbService);\n    84 | \n→   85 | app.get('/users/:id', userController.getUser.bind(userController));\n    86 | \n    87 | export default app;",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "app.get('/users/:id', userController.getUser.bind(userController));",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-csp-header-1762722081074-txm2livn8",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
            "line": 8,
            "column": 12
          },
          "snippet": "     6 | import mysql from 'mysql2/promise';\n     7 | \n→    8 | const app = express();\n     9 | app.use(express.json());\n    10 | ",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-x-frame-options-1762722081076-tuhkerm8x",
          "rule": "missing-x-frame-options",
          "severity": "medium",
          "category": "headers",
          "title": "Missing X-Frame-Options Header",
          "description": "Missing clickjacking protection header",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
            "line": 9,
            "column": 0
          },
          "snippet": "     7 | \n     8 | const app = express();\n→    9 | app.use(express.json());\n    10 | \n    11 | interface User {",
          "fix": {
            "recommendation": "Add X-Frame-Options header to prevent clickjacking.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.frameguard({ action: 'deny' }));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader('X-Frame-Options', 'DENY');\n  // Or: res.setHeader('X-Frame-Options', 'SAMEORIGIN');\n  next();\n});\n",
            "before": "app.use(express.json());",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options",
              "https://owasp.org/www-project-secure-headers/#x-frame-options"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-1021",
            "owasp": "A04:2021"
          }
        },
        {
          "id": "missing-x-content-type-options-1762722081076-0kqn3ze4u",
          "rule": "missing-x-content-type-options",
          "severity": "medium",
          "category": "headers",
          "title": "Missing X-Content-Type-Options Header",
          "description": "Missing MIME type sniffing protection",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
            "line": 9,
            "column": 0
          },
          "snippet": "     7 | \n     8 | const app = express();\n→    9 | app.use(express.json());\n    10 | \n    11 | interface User {",
          "fix": {
            "recommendation": "Add X-Content-Type-Options header to prevent MIME sniffing.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.noSniff());\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader('X-Content-Type-Options', 'nosniff');\n  next();\n});\n",
            "before": "app.use(express.json());",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options",
              "https://owasp.org/www-project-secure-headers/#x-content-type-options"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-referrer-policy-1762722081076-7z4khaik3",
          "rule": "missing-referrer-policy",
          "severity": "low",
          "category": "headers",
          "title": "Missing Referrer-Policy Header",
          "description": "Referrer-Policy header missing, potentially leaking sensitive information",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
            "line": 9,
            "column": 0
          },
          "snippet": "     7 | \n     8 | const app = express();\n→    9 | app.use(express.json());\n    10 | \n    11 | interface User {",
          "fix": {
            "recommendation": "Add Referrer-Policy header to control referrer information.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.referrerPolicy({ policy: 'strict-origin-when-cross-origin' }));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader('Referrer-Policy', 'strict-origin-when-cross-origin');\n  next();\n});\n",
            "before": "app.use(express.json());",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy",
              "https://owasp.org/www-project-secure-headers/#referrer-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-200",
            "owasp": "A01:2021"
          }
        },
        {
          "id": "missing-permissions-policy-1762722081076-8jmqgpywq",
          "rule": "missing-permissions-policy",
          "severity": "low",
          "category": "headers",
          "title": "Missing Permissions-Policy Header",
          "description": "Permissions-Policy (formerly Feature-Policy) header missing",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
            "line": 9,
            "column": 0
          },
          "snippet": "     7 | \n     8 | const app = express();\n→    9 | app.use(express.json());\n    10 | \n    11 | interface User {",
          "fix": {
            "recommendation": "Add Permissions-Policy header to control browser features.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.permittedCrossDomainPolicies());\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Permissions-Policy',\n    'geolocation=(), microphone=(), camera=()'\n  );\n  next();\n});\n",
            "before": "app.use(express.json());",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Permissions-Policy",
              "https://owasp.org/www-project-secure-headers/#permissions-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "x-powered-by-header-1762722081077-1ed8i2f2i",
          "rule": "x-powered-by-header",
          "severity": "low",
          "category": "headers",
          "title": "X-Powered-By Header Exposure",
          "description": "X-Powered-By header reveals technology stack information",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
            "line": 8,
            "column": 12
          },
          "snippet": "     6 | import mysql from 'mysql2/promise';\n     7 | \n→    8 | const app = express();\n     9 | app.use(express.json());\n    10 | ",
          "fix": {
            "recommendation": "Remove or disable X-Powered-By header.\n\nBefore:\nconst app = express();\n\nAfter:\nconst app = express();\napp.disable('x-powered-by');\n\n// Or use helmet:\napp.use(helmet.hidePoweredBy());\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/",
              "https://expressjs.com/en/advanced/best-practice-security.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-200",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-content-security-policy-1762722081082-vwft7aapl",
          "rule": "missing-content-security-policy",
          "severity": "high",
          "category": "web-security",
          "title": "Missing Content-Security-Policy Header",
          "description": "CSP header missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
            "line": 9,
            "column": 0
          },
          "snippet": "     7 | \n     8 | const app = express();\n→    9 | app.use(express.json());\n    10 | \n    11 | interface User {",
          "fix": {
            "recommendation": "Add Content-Security-Policy header using helmet middleware.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n  }\n}));\n",
            "before": "app.use(express.json());",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#content-security-policy",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-content-security-policy-1762722081082-ofkpnleot",
          "rule": "missing-content-security-policy",
          "severity": "high",
          "category": "web-security",
          "title": "Missing Content-Security-Policy Header",
          "description": "CSP header missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
            "line": 8,
            "column": 12
          },
          "snippet": "     6 | import mysql from 'mysql2/promise';\n     7 | \n→    8 | const app = express();\n     9 | app.use(express.json());\n    10 | ",
          "fix": {
            "recommendation": "Add Content-Security-Policy header using helmet middleware.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n  }\n}));\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#content-security-policy",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-x-frame-options-1762722081082-6ss8cp6a1",
          "rule": "missing-x-frame-options",
          "severity": "medium",
          "category": "web-security",
          "title": "Missing X-Frame-Options Header",
          "description": "Missing protection against clickjacking attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
            "line": 9,
            "column": 0
          },
          "snippet": "     7 | \n     8 | const app = express();\n→    9 | app.use(express.json());\n    10 | \n    11 | interface User {",
          "fix": {
            "recommendation": "Add X-Frame-Options header to prevent clickjacking.\n\nBefore (Express):\nconst app = express();\n\nAfter (Express):\napp.use(helmet.frameguard({ action: 'deny' }));\n// Or: app.use((req, res, next) => {\n//   res.setHeader('X-Frame-Options', 'DENY');\n//   next();\n// });\n\nBefore (Flask):\n@app.route('/')\ndef index():\n    return render_template('index.html')\n\nAfter (Flask):\n@app.after_request\ndef set_security_headers(response):\n    response.headers['X-Frame-Options'] = 'DENY'\n    return response\n",
            "before": "app.use(express.json());",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#x-frame-options",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-1021",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-x-content-type-options-1762722081082-xdvde5fkc",
          "rule": "missing-x-content-type-options",
          "severity": "low",
          "category": "web-security",
          "title": "Missing X-Content-Type-Options Header",
          "description": "Missing protection against MIME type sniffing attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
            "line": 64,
            "column": 8
          },
          "snippet": "    62 | \n    63 |       if (user) {\n→   64 |         res.json(user);\n    65 |       } else {\n    66 |         res.status(404).json({ error: 'User not found' });",
          "fix": {
            "recommendation": "Add X-Content-Type-Options header to prevent MIME sniffing.\n\nBefore:\nres.send(html);\n\nAfter:\napp.use(helmet.noSniff());\n// Or: res.setHeader('X-Content-Type-Options', 'nosniff');\nres.send(html);\n",
            "before": "res.json(user);",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#x-content-type-options",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-430",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-referrer-policy-1762722081082-hsn5p9vfc",
          "rule": "missing-referrer-policy",
          "severity": "low",
          "category": "web-security",
          "title": "Missing Referrer-Policy Header",
          "description": "Referrer header may leak sensitive information",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
            "line": 9,
            "column": 0
          },
          "snippet": "     7 | \n     8 | const app = express();\n→    9 | app.use(express.json());\n    10 | \n    11 | interface User {",
          "fix": {
            "recommendation": "Add Referrer-Policy header to control referrer information.\n\nBefore:\nconst app = express();\n\nAfter:\napp.use(helmet.referrerPolicy({ policy: 'strict-origin-when-cross-origin' }));\n// Or stricter: policy: 'no-referrer'\n",
            "before": "app.use(express.json());",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#referrer-policy",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-200",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-permissions-policy-1762722081083-hxdju6bgd",
          "rule": "missing-permissions-policy",
          "severity": "low",
          "category": "web-security",
          "title": "Missing Permissions-Policy Header",
          "description": "Permissions-Policy header missing, allowing unnecessary browser features",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/complex-vulnerable/ast-sql-injection.ts",
            "line": 9,
            "column": 0
          },
          "snippet": "     7 | \n     8 | const app = express();\n→    9 | app.use(express.json());\n    10 | \n    11 | interface User {",
          "fix": {
            "recommendation": "Add Permissions-Policy header to restrict browser features.\n\nBefore:\nconst app = express();\n\nAfter:\napp.use((req, res, next) => {\n  res.setHeader('Permissions-Policy',\n    'geolocation=(), camera=(), microphone=(), payment=()');\n  next();\n});\n",
            "before": "app.use(express.json());",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#permissions-policy",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Permissions-Policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        }
      ]
    ],
    [
      "1649d0fb56b12d25227d5135a8acd82fc807315b",
      []
    ],
    [
      "0513f9f8bbeae5054b917374910eb55a3111e5f8",
      [
        {
          "id": "ast-sql-injection-1762722082031-3javind0z",
          "rule": "ast-sql-injection",
          "severity": "critical",
          "category": "injection",
          "title": "SQL Injection Detected",
          "description": "SQL injection vulnerabilities detected in query construction",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/sql-injection.js",
            "line": 8,
            "column": 17
          },
          "snippet": "     6 | \n     7 | app.get('/user', (req, res) => {\n→    8 |   const query = `SELECT * FROM users WHERE id = ${req.query.id}`;\n     9 |   db.query(query, (err, results) => {\n    10 |     res.json(results);",
          "fix": {
            "recommendation": "Use parameterized queries or prepared statements instead of string concatenation",
            "before": "const query = `SELECT * FROM users WHERE id = ${req.query.id}`;",
            "after": "",
            "references": [
              "https://owasp.org/www-community/attacks/SQL_Injection",
              "https://cwe.mitre.org/data/definitions/89.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-89",
            "owasp": "A03:2021"
          }
        },
        {
          "id": "ast-sql-injection-1762722082031-oy8fiwchz",
          "rule": "ast-sql-injection",
          "severity": "critical",
          "category": "injection",
          "title": "SQL Injection Detected",
          "description": "SQL injection vulnerabilities detected in query construction",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/sql-injection.js",
            "line": 15,
            "column": 23
          },
          "snippet": "    13 | \n    14 | app.get('/search', (req, res) => {\n→   15 |   const searchQuery = `SELECT * FROM products WHERE name LIKE '%${req.query.term}%'`;\n    16 |   db.execute(searchQuery, (err, results) => {\n    17 |     res.json(results);",
          "fix": {
            "recommendation": "Use parameterized queries or prepared statements instead of string concatenation",
            "before": "const searchQuery = `SELECT * FROM products WHERE name LIKE '%${req.query.term}%'`;",
            "after": "",
            "references": [
              "https://owasp.org/www-community/attacks/SQL_Injection",
              "https://cwe.mitre.org/data/definitions/89.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-89",
            "owasp": "A03:2021"
          }
        },
        {
          "id": "ast-sql-injection-1762722082031-a5gkdhd9d",
          "rule": "ast-sql-injection",
          "severity": "critical",
          "category": "injection",
          "title": "SQL Injection Detected",
          "description": "SQL injection vulnerabilities detected in query construction",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/sql-injection.js",
            "line": 8,
            "column": 16
          },
          "snippet": "     6 | \n     7 | app.get('/user', (req, res) => {\n→    8 |   const query = `SELECT * FROM users WHERE id = ${req.query.id}`;\n     9 |   db.query(query, (err, results) => {\n    10 |     res.json(results);",
          "fix": {
            "recommendation": "Use parameterized queries or prepared statements instead of string concatenation",
            "before": "const query = `SELECT * FROM users WHERE id = ${req.query.id}`;",
            "after": "",
            "references": [
              "https://owasp.org/www-community/attacks/SQL_Injection",
              "https://cwe.mitre.org/data/definitions/89.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-89",
            "owasp": "A03:2021"
          }
        },
        {
          "id": "ast-sql-injection-1762722082031-puqrkoryg",
          "rule": "ast-sql-injection",
          "severity": "critical",
          "category": "injection",
          "title": "SQL Injection Detected",
          "description": "SQL injection vulnerabilities detected in query construction",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/sql-injection.js",
            "line": 15,
            "column": 22
          },
          "snippet": "    13 | \n    14 | app.get('/search', (req, res) => {\n→   15 |   const searchQuery = `SELECT * FROM products WHERE name LIKE '%${req.query.term}%'`;\n    16 |   db.execute(searchQuery, (err, results) => {\n    17 |     res.json(results);",
          "fix": {
            "recommendation": "Use parameterized queries or prepared statements instead of string concatenation",
            "before": "const searchQuery = `SELECT * FROM products WHERE name LIKE '%${req.query.term}%'`;",
            "after": "",
            "references": [
              "https://owasp.org/www-community/attacks/SQL_Injection",
              "https://cwe.mitre.org/data/definitions/89.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-89",
            "owasp": "A03:2021"
          }
        },
        {
          "id": "sql-injection-1762722082040-d15d4ph6n",
          "rule": "sql-injection",
          "severity": "critical",
          "category": "injection",
          "title": "SQL Injection Vulnerability",
          "description": "Unsanitized user input is used directly in SQL queries, allowing attackers to manipulate database queries",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/sql-injection.js",
            "line": 8,
            "column": 17
          },
          "snippet": "     6 | \n     7 | app.get('/user', (req, res) => {\n→    8 |   const query = `SELECT * FROM users WHERE id = ${req.query.id}`;\n     9 |   db.query(query, (err, results) => {\n    10 |     res.json(results);",
          "fix": {
            "recommendation": "Use parameterized queries or prepared statements. Never concatenate user input directly into SQL queries.",
            "before": "const query = `SELECT * FROM users WHERE id = ${req.query.id}`;",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A1_2017-Injection",
              "https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html",
              "https://cwe.mitre.org/data/definitions/89.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-89",
            "owasp": "A1:2017"
          }
        },
        {
          "id": "missing-csp-header-1762722082041-2jloqijb7",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/sql-injection.js",
            "line": 7,
            "column": 0
          },
          "snippet": "     5 | const app = express();\n     6 | \n→    7 | app.get('/user', (req, res) => {\n     8 |   const query = `SELECT * FROM users WHERE id = ${req.query.id}`;\n     9 |   db.query(query, (err, results) => {",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "app.get('/user', (req, res) => {",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-csp-header-1762722082041-w8urw82l8",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/sql-injection.js",
            "line": 14,
            "column": 0
          },
          "snippet": "    12 | });\n    13 | \n→   14 | app.get('/search', (req, res) => {\n    15 |   const searchQuery = `SELECT * FROM products WHERE name LIKE '%${req.query.term}%'`;\n    16 |   db.execute(searchQuery, (err, results) => {",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "app.get('/search', (req, res) => {",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-csp-header-1762722082041-i67w20ma2",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/sql-injection.js",
            "line": 5,
            "column": 12
          },
          "snippet": "     3 | \n     4 | const express = require('express');\n→    5 | const app = express();\n     6 | \n     7 | app.get('/user', (req, res) => {",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "x-powered-by-header-1762722082042-7ex8mn5bc",
          "rule": "x-powered-by-header",
          "severity": "low",
          "category": "headers",
          "title": "X-Powered-By Header Exposure",
          "description": "X-Powered-By header reveals technology stack information",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/sql-injection.js",
            "line": 5,
            "column": 12
          },
          "snippet": "     3 | \n     4 | const express = require('express');\n→    5 | const app = express();\n     6 | \n     7 | app.get('/user', (req, res) => {",
          "fix": {
            "recommendation": "Remove or disable X-Powered-By header.\n\nBefore:\nconst app = express();\n\nAfter:\nconst app = express();\napp.disable('x-powered-by');\n\n// Or use helmet:\napp.use(helmet.hidePoweredBy());\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/",
              "https://expressjs.com/en/advanced/best-practice-security.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-200",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-content-security-policy-1762722082044-whe6k8ezw",
          "rule": "missing-content-security-policy",
          "severity": "high",
          "category": "web-security",
          "title": "Missing Content-Security-Policy Header",
          "description": "CSP header missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/sql-injection.js",
            "line": 5,
            "column": 12
          },
          "snippet": "     3 | \n     4 | const express = require('express');\n→    5 | const app = express();\n     6 | \n     7 | app.get('/user', (req, res) => {",
          "fix": {
            "recommendation": "Add Content-Security-Policy header using helmet middleware.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n  }\n}));\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#content-security-policy",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-x-content-type-options-1762722082044-yg1b8a51o",
          "rule": "missing-x-content-type-options",
          "severity": "low",
          "category": "web-security",
          "title": "Missing X-Content-Type-Options Header",
          "description": "Missing protection against MIME type sniffing attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/sql-injection.js",
            "line": 10,
            "column": 4
          },
          "snippet": "     8 |   const query = `SELECT * FROM users WHERE id = ${req.query.id}`;\n     9 |   db.query(query, (err, results) => {\n→   10 |     res.json(results);\n    11 |   });\n    12 | });",
          "fix": {
            "recommendation": "Add X-Content-Type-Options header to prevent MIME sniffing.\n\nBefore:\nres.send(html);\n\nAfter:\napp.use(helmet.noSniff());\n// Or: res.setHeader('X-Content-Type-Options', 'nosniff');\nres.send(html);\n",
            "before": "res.json(results);",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#x-content-type-options",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-430",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-x-content-type-options-1762722082044-ko3vfsa11",
          "rule": "missing-x-content-type-options",
          "severity": "low",
          "category": "web-security",
          "title": "Missing X-Content-Type-Options Header",
          "description": "Missing protection against MIME type sniffing attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/sql-injection.js",
            "line": 17,
            "column": 4
          },
          "snippet": "    15 |   const searchQuery = `SELECT * FROM products WHERE name LIKE '%${req.query.term}%'`;\n    16 |   db.execute(searchQuery, (err, results) => {\n→   17 |     res.json(results);\n    18 |   });\n    19 | });",
          "fix": {
            "recommendation": "Add X-Content-Type-Options header to prevent MIME sniffing.\n\nBefore:\nres.send(html);\n\nAfter:\napp.use(helmet.noSniff());\n// Or: res.setHeader('X-Content-Type-Options', 'nosniff');\nres.send(html);\n",
            "before": "res.json(results);",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#x-content-type-options",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-430",
            "owasp": "A05:2021"
          }
        }
      ]
    ],
    [
      "3a0eaeff9506f9e8e8fca9fa19d1c41f008c947f",
      [
        {
          "id": "command-injection-1762722082326-kbu4q5imk",
          "rule": "command-injection",
          "severity": "critical",
          "category": "injection",
          "title": "Command Injection Vulnerability",
          "description": "User input is passed to system commands without validation, allowing arbitrary command execution",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/command-injection.py",
            "line": 8,
            "column": 4
          },
          "snippet": "     6 | \n     7 | def ping_host(host):\n→    8 |     os.system(f\"ping -c 1 {host}\")\n     9 | \n    10 | def process_file(filename):",
          "fix": {
            "recommendation": "Avoid passing user input to system commands. If necessary, use allowlists and strict input validation.",
            "before": "os.system(f\"ping -c 1 {host}\")",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A1_2017-Injection",
              "https://cwe.mitre.org/data/definitions/78.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-78",
            "owasp": "A1:2017"
          }
        },
        {
          "id": "command-injection-1762722082326-ugogj9wnb",
          "rule": "command-injection",
          "severity": "critical",
          "category": "injection",
          "title": "Command Injection Vulnerability",
          "description": "User input is passed to system commands without validation, allowing arbitrary command execution",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/command-injection.py",
            "line": 14,
            "column": 4
          },
          "snippet": "    12 | \n    13 | def backup_data(path):\n→   14 |     os.system(f\"tar -czf backup.tar.gz {path}\")\n    15 | ",
          "fix": {
            "recommendation": "Avoid passing user input to system commands. If necessary, use allowlists and strict input validation.",
            "before": "os.system(f\"tar -czf backup.tar.gz {path}\")",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A1_2017-Injection",
              "https://cwe.mitre.org/data/definitions/78.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-78",
            "owasp": "A1:2017"
          }
        },
        {
          "id": "shell-injection-python-1762722082327-9e3j0wxwv",
          "rule": "shell-injection-python",
          "severity": "critical",
          "category": "injection",
          "title": "Shell Injection in Python",
          "description": "User input passed to os.system or shell=True allows command injection",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/command-injection.py",
            "line": 8,
            "column": 4
          },
          "snippet": "     6 | \n     7 | def ping_host(host):\n→    8 |     os.system(f\"ping -c 1 {host}\")\n     9 | \n    10 | def process_file(filename):",
          "fix": {
            "recommendation": "Use subprocess with shell=False and pass arguments as a list.\n\nBefore:\nos.system(f\"rm {user_file}\")\n\nAfter:\nsubprocess.run(['rm', user_file], shell=False)\n",
            "before": "os.system(f\"ping -c 1 {host}\")",
            "after": "",
            "references": [
              "https://owasp.org/www-community/attacks/Command_Injection",
              "https://docs.python.org/3/library/subprocess.html#security-considerations"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-78",
            "owasp": "A03:2021"
          }
        },
        {
          "id": "shell-injection-python-1762722082327-ykrvm3s4r",
          "rule": "shell-injection-python",
          "severity": "critical",
          "category": "injection",
          "title": "Shell Injection in Python",
          "description": "User input passed to os.system or shell=True allows command injection",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/command-injection.py",
            "line": 14,
            "column": 4
          },
          "snippet": "    12 | \n    13 | def backup_data(path):\n→   14 |     os.system(f\"tar -czf backup.tar.gz {path}\")\n    15 | ",
          "fix": {
            "recommendation": "Use subprocess with shell=False and pass arguments as a list.\n\nBefore:\nos.system(f\"rm {user_file}\")\n\nAfter:\nsubprocess.run(['rm', user_file], shell=False)\n",
            "before": "os.system(f\"tar -czf backup.tar.gz {path}\")",
            "after": "",
            "references": [
              "https://owasp.org/www-community/attacks/Command_Injection",
              "https://docs.python.org/3/library/subprocess.html#security-considerations"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-78",
            "owasp": "A03:2021"
          }
        },
        {
          "id": "shell-injection-python-1762722082327-qz8icpd5m",
          "rule": "shell-injection-python",
          "severity": "critical",
          "category": "injection",
          "title": "Shell Injection in Python",
          "description": "User input passed to os.system or shell=True allows command injection",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/command-injection.py",
            "line": 11,
            "column": 4
          },
          "snippet": "     9 | \n    10 | def process_file(filename):\n→   11 |     subprocess.run(f\"cat {filename}\", shell=True)\n    12 | \n    13 | def backup_data(path):",
          "fix": {
            "recommendation": "Use subprocess with shell=False and pass arguments as a list.\n\nBefore:\nos.system(f\"rm {user_file}\")\n\nAfter:\nsubprocess.run(['rm', user_file], shell=False)\n",
            "before": "subprocess.run(f\"cat {filename}\", shell=True)",
            "after": "",
            "references": [
              "https://owasp.org/www-community/attacks/Command_Injection",
              "https://docs.python.org/3/library/subprocess.html#security-considerations"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-78",
            "owasp": "A03:2021"
          }
        }
      ]
    ],
    [
      "4aefbea12fd0504f3831517a0b9f97f9e87f5f19",
      [
        {
          "id": "missing-csrf-flask-1762722082331-kflimyhge",
          "rule": "missing-csrf-flask",
          "severity": "high",
          "category": "web-security",
          "title": "Missing CSRF Protection (Flask)",
          "description": "Flask application without CSRF protection enabled",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/path-traversal.py",
            "line": 4,
            "column": 0
          },
          "snippet": "     2 | # Should trigger: path-traversal\n     3 | \n→    4 | from flask import Flask, request, send_file\n     5 | \n     6 | app = Flask(__name__)",
          "fix": {
            "recommendation": "Enable Flask-WTF CSRF protection.\n\nBefore:\nfrom flask import Flask\napp = Flask(__name__)\n\n@app.route('/transfer', methods=['POST'])\ndef transfer():\n    pass\n\nAfter:\nfrom flask import Flask\nfrom flask_wtf.csrf import CSRFProtect\n\napp = Flask(__name__)\napp.config['SECRET_KEY'] = os.environ.get('SECRET_KEY')\ncsrf = CSRFProtect(app)\n\n@app.route('/transfer', methods=['POST'])\ndef transfer():\n    pass  # CSRF automatically validated\n",
            "before": "from flask import Flask, request, send_file",
            "after": "",
            "references": [
              "https://flask-wtf.readthedocs.io/en/stable/csrf.html",
              "https://cwe.mitre.org/data/definitions/352.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-352",
            "owasp": "A01:2021"
          }
        },
        {
          "id": "path-traversal-1762722082332-1chwizb6o",
          "rule": "path-traversal",
          "severity": "high",
          "category": "injection",
          "title": "Path Traversal Vulnerability",
          "description": "User input is used in file paths without validation, allowing access to unauthorized files",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/path-traversal.py",
            "line": 16,
            "column": 9
          },
          "snippet": "    14 | def read_file():\n    15 |     path = request.args.get('path')\n→   16 |     with open(f\"{path}\", 'r') as f:\n    17 |         return f.read()\n    18 | ",
          "fix": {
            "recommendation": "Validate and sanitize file paths. Use path.resolve() and check that the resolved path is within allowed directories.",
            "before": "with open(f\"{path}\", 'r') as f:",
            "after": "",
            "references": [
              "https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/05-Authorization_Testing/01-Testing_Directory_Traversal_File_Include",
              "https://cwe.mitre.org/data/definitions/22.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-22",
            "owasp": "A5:2017"
          }
        },
        {
          "id": "path-traversal-python-1762722082332-gda7j8emk",
          "rule": "path-traversal-python",
          "severity": "critical",
          "category": "injection",
          "title": "Path Traversal in Python",
          "description": "User input in file operations without validation in Python",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/path-traversal.py",
            "line": 16,
            "column": 9
          },
          "snippet": "    14 | def read_file():\n    15 |     path = request.args.get('path')\n→   16 |     with open(f\"{path}\", 'r') as f:\n    17 |         return f.read()\n    18 | ",
          "fix": {
            "recommendation": "Use pathlib and validate paths stay within allowed directories.\n\nBefore:\nwith open(f\"./uploads/{user_file}\") as f:\n\nAfter:\nfrom pathlib import Path\nbase_dir = Path(\"./uploads\").resolve()\nfilepath = (base_dir / user_file).resolve()\nif not filepath.is_relative_to(base_dir):\n    raise ValueError(\"Invalid path\")\nwith open(filepath) as f:\n",
            "before": "with open(f\"{path}\", 'r') as f:",
            "after": "",
            "references": [
              "https://owasp.org/www-community/attacks/Path_Traversal",
              "https://cwe.mitre.org/data/definitions/22.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-22",
            "owasp": "A01:2021"
          }
        }
      ]
    ],
    [
      "a0c1dade9d68c02d973cd7a57367876e0a20a1a7",
      [
        {
          "id": "hardcoded-password-1762722082335-cwjpuzxx3",
          "rule": "hardcoded-password",
          "severity": "critical",
          "category": "secrets",
          "title": "Hardcoded Password Detected",
          "description": "Passwords should never be hardcoded in source code. Store them securely in environment variables or secure credential stores.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/incomplete-security.js",
            "line": 28,
            "column": 4
          },
          "snippet": "    26 | const config = {\n    27 |   apiKey: \"YOUR_API_KEY_HERE\",\n→   28 |   dbPassword: \"changeme\",\n    29 |   secretToken: \"placeholder-token\",\n    30 |   adminUser: \"admin\",",
          "fix": {
            "recommendation": "Store passwords in environment variables (e.g., process.env.DB_PASSWORD) or use a secure credential management system",
            "before": "dbPassword: \"changeme\",",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "security-todo-1762722082336-3dn90mw7w",
          "rule": "security-todo",
          "severity": "high",
          "category": "incomplete",
          "title": "Security TODO/FIXME Found",
          "description": "Incomplete security implementations leave systems vulnerable. TODOs in security code indicate unfinished protection mechanisms that attackers can exploit",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/incomplete-security.js",
            "line": 8,
            "column": 3
          },
          "snippet": "     6 | \n     7 | // Issue 1: Security TODO\n→    8 | // TODO: Add proper authentication before production\n     9 | // TODO: Implement password strength validation\n    10 | function login(username, password) {",
          "fix": {
            "recommendation": "Complete all security implementations before deploying to production\n\nBefore:\n// TODO: Add password validation\nfunction login(password) { ... }\n\nAfter:\nfunction login(password) {\n  if (!validatePassword(password)) {\n    throw new Error('Invalid password');\n  }\n  ...\n}\n",
            "before": "// TODO: Add proper authentication before production",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-489",
            "owasp": "OWASP A4:2021"
          }
        },
        {
          "id": "security-todo-1762722082336-uokwp903q",
          "rule": "security-todo",
          "severity": "high",
          "category": "incomplete",
          "title": "Security TODO/FIXME Found",
          "description": "Incomplete security implementations leave systems vulnerable. TODOs in security code indicate unfinished protection mechanisms that attackers can exploit",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/incomplete-security.js",
            "line": 9,
            "column": 3
          },
          "snippet": "     7 | // Issue 1: Security TODO\n     8 | // TODO: Add proper authentication before production\n→    9 | // TODO: Implement password strength validation\n    10 | function login(username, password) {\n    11 |   // FIXME: Need to add rate limiting for security",
          "fix": {
            "recommendation": "Complete all security implementations before deploying to production\n\nBefore:\n// TODO: Add password validation\nfunction login(password) { ... }\n\nAfter:\nfunction login(password) {\n  if (!validatePassword(password)) {\n    throw new Error('Invalid password');\n  }\n  ...\n}\n",
            "before": "// TODO: Implement password strength validation",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-489",
            "owasp": "OWASP A4:2021"
          }
        },
        {
          "id": "security-todo-1762722082336-pjfwqoh5d",
          "rule": "security-todo",
          "severity": "high",
          "category": "incomplete",
          "title": "Security TODO/FIXME Found",
          "description": "Incomplete security implementations leave systems vulnerable. TODOs in security code indicate unfinished protection mechanisms that attackers can exploit",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/incomplete-security.js",
            "line": 11,
            "column": 5
          },
          "snippet": "     9 | // TODO: Implement password strength validation\n    10 | function login(username, password) {\n→   11 |   // FIXME: Need to add rate limiting for security\n    12 |   return authenticateUser(username, password);\n    13 | }",
          "fix": {
            "recommendation": "Complete all security implementations before deploying to production\n\nBefore:\n// TODO: Add password validation\nfunction login(password) { ... }\n\nAfter:\nfunction login(password) {\n  if (!validatePassword(password)) {\n    throw new Error('Invalid password');\n  }\n  ...\n}\n",
            "before": "// FIXME: Need to add rate limiting for security",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-489",
            "owasp": "OWASP A4:2021"
          }
        },
        {
          "id": "security-todo-1762722082336-x1j3rqodm",
          "rule": "security-todo",
          "severity": "high",
          "category": "incomplete",
          "title": "Security TODO/FIXME Found",
          "description": "Incomplete security implementations leave systems vulnerable. TODOs in security code indicate unfinished protection mechanisms that attackers can exploit",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/incomplete-security.js",
            "line": 58,
            "column": 3
          },
          "snippet": "    56 | \n    57 | // More security TODOs\n→   58 | // FIXME: Add encryption before storing sensitive data\n    59 | function storeUserData(data) {\n    60 |   // TODO: Hash password before storing",
          "fix": {
            "recommendation": "Complete all security implementations before deploying to production\n\nBefore:\n// TODO: Add password validation\nfunction login(password) { ... }\n\nAfter:\nfunction login(password) {\n  if (!validatePassword(password)) {\n    throw new Error('Invalid password');\n  }\n  ...\n}\n",
            "before": "// FIXME: Add encryption before storing sensitive data",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-489",
            "owasp": "OWASP A4:2021"
          }
        },
        {
          "id": "security-todo-1762722082336-he43mzxtp",
          "rule": "security-todo",
          "severity": "high",
          "category": "incomplete",
          "title": "Security TODO/FIXME Found",
          "description": "Incomplete security implementations leave systems vulnerable. TODOs in security code indicate unfinished protection mechanisms that attackers can exploit",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/incomplete-security.js",
            "line": 60,
            "column": 5
          },
          "snippet": "    58 | // FIXME: Add encryption before storing sensitive data\n    59 | function storeUserData(data) {\n→   60 |   // TODO: Hash password before storing\n    61 |   return db.insert(data);\n    62 | }",
          "fix": {
            "recommendation": "Complete all security implementations before deploying to production\n\nBefore:\n// TODO: Add password validation\nfunction login(password) { ... }\n\nAfter:\nfunction login(password) {\n  if (!validatePassword(password)) {\n    throw new Error('Invalid password');\n  }\n  ...\n}\n",
            "before": "// TODO: Hash password before storing",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-489",
            "owasp": "OWASP A4:2021"
          }
        },
        {
          "id": "security-todo-1762722082336-kd1qoo1jc",
          "rule": "security-todo",
          "severity": "high",
          "category": "incomplete",
          "title": "Security TODO/FIXME Found",
          "description": "Incomplete security implementations leave systems vulnerable. TODOs in security code indicate unfinished protection mechanisms that attackers can exploit",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/incomplete-security.js",
            "line": 57,
            "column": 8
          },
          "snippet": "    55 | }\n    56 | \n→   57 | // More security TODOs\n    58 | // FIXME: Add encryption before storing sensitive data\n    59 | function storeUserData(data) {",
          "fix": {
            "recommendation": "Complete all security implementations before deploying to production\n\nBefore:\n// TODO: Add password validation\nfunction login(password) { ... }\n\nAfter:\nfunction login(password) {\n  if (!validatePassword(password)) {\n    throw new Error('Invalid password');\n  }\n  ...\n}\n",
            "before": "// More security TODOs",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-489",
            "owasp": "OWASP A4:2021"
          }
        },
        {
          "id": "security-todo-1762722082336-xjtngxzpg",
          "rule": "security-todo",
          "severity": "high",
          "category": "incomplete",
          "title": "Security TODO/FIXME Found",
          "description": "Incomplete security implementations leave systems vulnerable. TODOs in security code indicate unfinished protection mechanisms that attackers can exploit",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/incomplete-security.js",
            "line": 8,
            "column": 0
          },
          "snippet": "     6 | \n     7 | // Issue 1: Security TODO\n→    8 | // TODO: Add proper authentication before production\n     9 | // TODO: Implement password strength validation\n    10 | function login(username, password) {",
          "fix": {
            "recommendation": "Complete all security implementations before deploying to production\n\nBefore:\n// TODO: Add password validation\nfunction login(password) { ... }\n\nAfter:\nfunction login(password) {\n  if (!validatePassword(password)) {\n    throw new Error('Invalid password');\n  }\n  ...\n}\n",
            "before": "// TODO: Add proper authentication before production",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-489",
            "owasp": "OWASP A4:2021"
          }
        },
        {
          "id": "security-todo-1762722082336-o7mi4hg6r",
          "rule": "security-todo",
          "severity": "high",
          "category": "incomplete",
          "title": "Security TODO/FIXME Found",
          "description": "Incomplete security implementations leave systems vulnerable. TODOs in security code indicate unfinished protection mechanisms that attackers can exploit",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/incomplete-security.js",
            "line": 9,
            "column": 0
          },
          "snippet": "     7 | // Issue 1: Security TODO\n     8 | // TODO: Add proper authentication before production\n→    9 | // TODO: Implement password strength validation\n    10 | function login(username, password) {\n    11 |   // FIXME: Need to add rate limiting for security",
          "fix": {
            "recommendation": "Complete all security implementations before deploying to production\n\nBefore:\n// TODO: Add password validation\nfunction login(password) { ... }\n\nAfter:\nfunction login(password) {\n  if (!validatePassword(password)) {\n    throw new Error('Invalid password');\n  }\n  ...\n}\n",
            "before": "// TODO: Implement password strength validation",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-489",
            "owasp": "OWASP A4:2021"
          }
        },
        {
          "id": "security-todo-1762722082336-k6t5313bb",
          "rule": "security-todo",
          "severity": "high",
          "category": "incomplete",
          "title": "Security TODO/FIXME Found",
          "description": "Incomplete security implementations leave systems vulnerable. TODOs in security code indicate unfinished protection mechanisms that attackers can exploit",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/incomplete-security.js",
            "line": 60,
            "column": 2
          },
          "snippet": "    58 | // FIXME: Add encryption before storing sensitive data\n    59 | function storeUserData(data) {\n→   60 |   // TODO: Hash password before storing\n    61 |   return db.insert(data);\n    62 | }",
          "fix": {
            "recommendation": "Complete all security implementations before deploying to production\n\nBefore:\n// TODO: Add password validation\nfunction login(password) { ... }\n\nAfter:\nfunction login(password) {\n  if (!validatePassword(password)) {\n    throw new Error('Invalid password');\n  }\n  ...\n}\n",
            "before": "// TODO: Hash password before storing",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-489",
            "owasp": "OWASP A4:2021"
          }
        },
        {
          "id": "hardcoded-password-1762722082353-lyypm7mbf",
          "rule": "hardcoded-password",
          "severity": "critical",
          "category": "secrets",
          "title": "Hardcoded Password Detected",
          "description": "Passwords should never be hardcoded in source code. Store them securely in environment variables or secure credential stores.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/incomplete-security.js",
            "line": 28,
            "column": 4
          },
          "snippet": "    26 | const config = {\n    27 |   apiKey: \"YOUR_API_KEY_HERE\",\n→   28 |   dbPassword: \"changeme\",\n    29 |   secretToken: \"placeholder-token\",\n    30 |   adminUser: \"admin\",",
          "fix": {
            "recommendation": "Store passwords in environment variables (e.g., process.env.DB_PASSWORD) or use a secure credential management system",
            "before": "dbPassword: \"changeme\",",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "missing-csp-header-1762722082361-ovti27m8e",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/incomplete-security.js",
            "line": 5,
            "column": 12
          },
          "snippet": "     3 | \n     4 | const express = require('express');\n→    5 | const app = express();\n     6 | \n     7 | // Issue 1: Security TODO",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "x-powered-by-header-1762722082363-6zgyaba54",
          "rule": "x-powered-by-header",
          "severity": "low",
          "category": "headers",
          "title": "X-Powered-By Header Exposure",
          "description": "X-Powered-By header reveals technology stack information",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/incomplete-security.js",
            "line": 5,
            "column": 12
          },
          "snippet": "     3 | \n     4 | const express = require('express');\n→    5 | const app = express();\n     6 | \n     7 | // Issue 1: Security TODO",
          "fix": {
            "recommendation": "Remove or disable X-Powered-By header.\n\nBefore:\nconst app = express();\n\nAfter:\nconst app = express();\napp.disable('x-powered-by');\n\n// Or use helmet:\napp.use(helmet.hidePoweredBy());\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/",
              "https://expressjs.com/en/advanced/best-practice-security.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-200",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-content-security-policy-1762722082369-hmbd9coqs",
          "rule": "missing-content-security-policy",
          "severity": "high",
          "category": "web-security",
          "title": "Missing Content-Security-Policy Header",
          "description": "CSP header missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/incomplete-security.js",
            "line": 5,
            "column": 12
          },
          "snippet": "     3 | \n     4 | const express = require('express');\n→    5 | const app = express();\n     6 | \n     7 | // Issue 1: Security TODO",
          "fix": {
            "recommendation": "Add Content-Security-Policy header using helmet middleware.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n  }\n}));\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#content-security-policy",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "insecure-jwt-algorithm-1762722082375-temfhhx0a",
          "rule": "insecure-jwt-algorithm",
          "severity": "critical",
          "category": "cryptography",
          "title": "Insecure JWT Algorithm",
          "description": "Using 'none' algorithm or allowing algorithm switching in JWT",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/incomplete-security.js",
            "line": 40,
            "column": 26
          },
          "snippet": "    38 | async function verifyToken(token) {\n    39 |   try {\n→   40 |     const decoded = await jwt.verify(token, SECRET_KEY);\n    41 |     return decoded;\n    42 |   } catch (e) {",
          "fix": {
            "recommendation": "Always specify and validate JWT algorithms. Never use 'none'.\n\nBefore:\njwt.verify(token, secret);\n\nAfter:\njwt.verify(token, secret, { algorithms: ['HS256'] });\n// Explicitly allow only the algorithms you use\n",
            "before": "const decoded = await jwt.verify(token, SECRET_KEY);",
            "after": "",
            "references": [
              "https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/",
              "https://cwe.mitre.org/data/definitions/327.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-327",
            "owasp": "A02:2021"
          }
        }
      ]
    ],
    [
      "29da042618d747c2d4ab2dff0b791f6f1abb3224",
      [
        {
          "id": "missing-csrf-protection-1762722082382-0po5biuk2",
          "rule": "missing-csrf-protection",
          "severity": "high",
          "category": "web-security",
          "title": "Missing CSRF Protection",
          "description": "State-changing endpoints lack CSRF token validation",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/weak-auth.js",
            "line": 18,
            "column": 0
          },
          "snippet": "    16 | \n    17 | // Issue 2: Missing rate limiting on login endpoint\n→   18 | app.post('/login', async (req, res) => {\n    19 |   const { username, password } = req.body;\n    20 |   ",
          "fix": {
            "recommendation": "Use CSRF protection middleware for state-changing requests.\n\nBefore:\napp.post('/transfer', (req, res) => {\n  // Transfer money\n});\n\nAfter:\nconst csrf = require('csurf');\nconst csrfProtection = csrf({ cookie: true });\n\napp.post('/transfer', csrfProtection, (req, res) => {\n  // CSRF token validated automatically\n});\n\n// In your form:\n// <input type=\"hidden\" name=\"_csrf\" value=\"<%= csrfToken %>\">\n",
            "before": "app.post('/login', async (req, res) => {",
            "after": "",
            "references": [
              "https://owasp.org/www-community/attacks/csrf",
              "https://cwe.mitre.org/data/definitions/352.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-352",
            "owasp": "A01:2021"
          }
        },
        {
          "id": "missing-csp-header-1762722082387-id4hybqt6",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/weak-auth.js",
            "line": 18,
            "column": 0
          },
          "snippet": "    16 | \n    17 | // Issue 2: Missing rate limiting on login endpoint\n→   18 | app.post('/login', async (req, res) => {\n    19 |   const { username, password } = req.body;\n    20 |   ",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "app.post('/login', async (req, res) => {",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-csp-header-1762722082387-hieieiar0",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/weak-auth.js",
            "line": 6,
            "column": 12
          },
          "snippet": "     4 | const express = require('express');\n     5 | const jwt = require('jsonwebtoken');\n→    6 | const app = express();\n     7 | \n     8 | // Issue 1: Weak password validation",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "x-powered-by-header-1762722082388-4vezv11gf",
          "rule": "x-powered-by-header",
          "severity": "low",
          "category": "headers",
          "title": "X-Powered-By Header Exposure",
          "description": "X-Powered-By header reveals technology stack information",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/weak-auth.js",
            "line": 6,
            "column": 12
          },
          "snippet": "     4 | const express = require('express');\n     5 | const jwt = require('jsonwebtoken');\n→    6 | const app = express();\n     7 | \n     8 | // Issue 1: Weak password validation",
          "fix": {
            "recommendation": "Remove or disable X-Powered-By header.\n\nBefore:\nconst app = express();\n\nAfter:\nconst app = express();\napp.disable('x-powered-by');\n\n// Or use helmet:\napp.use(helmet.hidePoweredBy());\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/",
              "https://expressjs.com/en/advanced/best-practice-security.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-200",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-content-security-policy-1762722082391-isy8znd3w",
          "rule": "missing-content-security-policy",
          "severity": "high",
          "category": "web-security",
          "title": "Missing Content-Security-Policy Header",
          "description": "CSP header missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/weak-auth.js",
            "line": 6,
            "column": 12
          },
          "snippet": "     4 | const express = require('express');\n     5 | const jwt = require('jsonwebtoken');\n→    6 | const app = express();\n     7 | \n     8 | // Issue 1: Weak password validation",
          "fix": {
            "recommendation": "Add Content-Security-Policy header using helmet middleware.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n  }\n}));\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#content-security-policy",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-x-content-type-options-1762722082391-4zfnfoqr4",
          "rule": "missing-x-content-type-options",
          "severity": "low",
          "category": "web-security",
          "title": "Missing X-Content-Type-Options Header",
          "description": "Missing protection against MIME type sniffing attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/weak-auth.js",
            "line": 34,
            "column": 4
          },
          "snippet": "    32 |     const tokenData = jwt.decode(user.token);\n    33 |     \n→   34 |     res.json({ success: true, user: tokenData });\n    35 |   } else {\n    36 |     res.status(401).json({ error: 'Authentication failed' });",
          "fix": {
            "recommendation": "Add X-Content-Type-Options header to prevent MIME sniffing.\n\nBefore:\nres.send(html);\n\nAfter:\napp.use(helmet.noSniff());\n// Or: res.setHeader('X-Content-Type-Options', 'nosniff');\nres.send(html);\n",
            "before": "res.json({ success: true, user: tokenData });",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#x-content-type-options",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-430",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "insecure-cookie-settings-1762722082391-gygxql19z",
          "rule": "insecure-cookie-settings",
          "severity": "medium",
          "category": "web-security",
          "title": "Insecure Cookie Settings",
          "description": "Cookies set without Secure, HttpOnly, or SameSite flags",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/weak-auth.js",
            "line": 29,
            "column": 4
          },
          "snippet": "    27 |   if (user) {\n    28 |     // Issue 3: Insecure session cookie - missing httpOnly, secure, sameSite\n→   29 |     res.cookie('sessionId', user.sessionToken);\n    30 |     \n    31 |     // Issue 4: JWT decoded without verification",
          "fix": {
            "recommendation": "Set security flags on all cookies.\n\nBefore:\nres.cookie('sessionId', token);\n\nAfter:\nres.cookie('sessionId', token, {\n  httpOnly: true,    // Prevent XSS access\n  secure: true,      // HTTPS only\n  sameSite: 'strict' // CSRF protection\n});\n",
            "before": "res.cookie('sessionId', user.sessionToken);",
            "after": "",
            "references": [
              "https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-614",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "weak-password-validation-1762722082394-bunegfbdl",
          "rule": "weak-password-validation",
          "severity": "high",
          "category": "auth",
          "title": "Weak Password Validation",
          "description": "Weak password requirements allow users to create easily guessable passwords, making accounts vulnerable to brute-force attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/weak-auth.js",
            "line": 11,
            "column": 6
          },
          "snippet": "     9 | function isValidPassword(password) {\n    10 |   // Only checking if length is greater than 5 - too weak!\n→   11 |   if (password.length < 6) {\n    12 |     return false;\n    13 |   }",
          "fix": {
            "recommendation": "Implement strong password requirements: minimum 12 characters, mix of uppercase, lowercase, numbers, and special characters\n\nBefore:\nif (password.length < 6) { return false; }\n\nAfter:\nif (password.length < 12 || \n    !/[A-Z]/.test(password) || \n    !/[a-z]/.test(password) || \n    !/[0-9]/.test(password) || \n    !/[^A-Za-z0-9]/.test(password)) {\n  return false;\n}\n",
            "before": "if (password.length < 6) {",
            "after": "",
            "references": [
              "https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/04-Authentication_Testing/07-Testing_for_Weak_Password_Policy",
              "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-521",
            "owasp": "OWASP A7:2021"
          }
        },
        {
          "id": "weak-password-validation-1762722082395-vds4okrx1",
          "rule": "weak-password-validation",
          "severity": "high",
          "category": "auth",
          "title": "Weak Password Validation",
          "description": "Weak password requirements allow users to create easily guessable passwords, making accounts vulnerable to brute-force attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/weak-auth.js",
            "line": 11,
            "column": 2
          },
          "snippet": "     9 | function isValidPassword(password) {\n    10 |   // Only checking if length is greater than 5 - too weak!\n→   11 |   if (password.length < 6) {\n    12 |     return false;\n    13 |   }",
          "fix": {
            "recommendation": "Implement strong password requirements: minimum 12 characters, mix of uppercase, lowercase, numbers, and special characters\n\nBefore:\nif (password.length < 6) { return false; }\n\nAfter:\nif (password.length < 12 || \n    !/[A-Z]/.test(password) || \n    !/[a-z]/.test(password) || \n    !/[0-9]/.test(password) || \n    !/[^A-Za-z0-9]/.test(password)) {\n  return false;\n}\n",
            "before": "if (password.length < 6) {",
            "after": "",
            "references": [
              "https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/04-Authentication_Testing/07-Testing_for_Weak_Password_Policy",
              "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-521",
            "owasp": "OWASP A7:2021"
          }
        },
        {
          "id": "missing-rate-limiting-1762722082395-ldb821y4v",
          "rule": "missing-rate-limiting",
          "severity": "critical",
          "category": "auth",
          "title": "Missing Rate Limiting on Authentication",
          "description": "Without rate limiting, attackers can attempt unlimited authentication attempts, enabling brute-force and credential stuffing attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/weak-auth.js",
            "line": 18,
            "column": 0
          },
          "snippet": "    16 | \n    17 | // Issue 2: Missing rate limiting on login endpoint\n→   18 | app.post('/login', async (req, res) => {\n    19 |   const { username, password } = req.body;\n    20 |   ",
          "fix": {
            "recommendation": "Implement rate limiting on authentication endpoints using middleware or decorators\n\nBefore:\napp.post('/login', async (req, res) => {\n  const user = await authenticate(req.body);\n});\n\nAfter:\nconst rateLimit = require('express-rate-limit');\nconst loginLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000, // 15 minutes\n  max: 5, // limit each IP to 5 requests per windowMs\n  message: 'Too many login attempts, please try again later'\n});\n\napp.post('/login', loginLimiter, async (req, res) => {\n  const user = await authenticate(req.body);\n});\n",
            "before": "app.post('/login', async (req, res) => {",
            "after": "",
            "references": [
              "https://owasp.org/www-community/controls/Blocking_Brute_Force_Attacks",
              "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-307",
            "owasp": "OWASP A7:2021"
          }
        },
        {
          "id": "insecure-session-config-1762722082395-gzshl9btg",
          "rule": "insecure-session-config",
          "severity": "high",
          "category": "auth",
          "title": "Insecure Session Configuration",
          "description": "Sessions without security flags are vulnerable to XSS attacks (no httpOnly), interception (no secure), and CSRF attacks (no sameSite)",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/weak-auth.js",
            "line": 29,
            "column": 8
          },
          "snippet": "    27 |   if (user) {\n    28 |     // Issue 3: Insecure session cookie - missing httpOnly, secure, sameSite\n→   29 |     res.cookie('sessionId', user.sessionToken);\n    30 |     \n    31 |     // Issue 4: JWT decoded without verification",
          "fix": {
            "recommendation": "Always set httpOnly, secure, and sameSite flags on session cookies\n\nBefore:\nres.cookie('sessionId', token);\n\nAfter:\nres.cookie('sessionId', token, {\n  httpOnly: true,    // Prevents JavaScript access\n  secure: true,      // HTTPS only\n  sameSite: 'strict' // CSRF protection\n});\n\nPython/Flask:\napp.config['SESSION_COOKIE_HTTPONLY'] = True\napp.config['SESSION_COOKIE_SECURE'] = True\napp.config['SESSION_COOKIE_SAMESITE'] = 'Strict'\n",
            "before": "res.cookie('sessionId', user.sessionToken);",
            "after": "",
            "references": [
              "https://owasp.org/www-community/controls/SecureCookieAttribute",
              "https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-614",
            "owasp": "OWASP A5:2021"
          }
        },
        {
          "id": "missing-jwt-verification-1762722082395-haq8tm5nq",
          "rule": "missing-jwt-verification",
          "severity": "critical",
          "category": "auth",
          "title": "JWT Token Used Without Verification",
          "description": "Unverified JWT tokens can be forged by attackers, allowing authentication bypass and privilege escalation",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/weak-auth.js",
            "line": 32,
            "column": 22
          },
          "snippet": "    30 |     \n    31 |     // Issue 4: JWT decoded without verification\n→   32 |     const tokenData = jwt.decode(user.token);\n    33 |     \n    34 |     res.json({ success: true, user: tokenData });",
          "fix": {
            "recommendation": "Always verify JWT signatures and validate claims\n\nBefore:\nconst decoded = jwt.decode(token);\n// OR\ndecoded = jwt.decode(token, verify=False)\n\nAfter:\nconst decoded = jwt.verify(token, SECRET_KEY, {\n  algorithms: ['HS256'],\n  issuer: 'your-app',\n  audience: 'your-api'\n});\n\nPython:\ndecoded = jwt.decode(\n  token, \n  SECRET_KEY, \n  algorithms=['HS256'],\n  verify=True,\n  audience='your-api'\n)\n",
            "before": "const tokenData = jwt.decode(user.token);",
            "after": "",
            "references": [
              "https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/",
              "https://cheatsheetseries.owasp.org/cheatsheets/JSON_Web_Token_for_Java_Cheat_Sheet.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-347",
            "owasp": "OWASP A2:2021"
          }
        }
      ]
    ],
    [
      "ae85cb3bed1a502b3306fa55ffdad50f5983480e",
      [
        {
          "id": "hardcoded-password-1762722082396-jiky7pr6q",
          "rule": "hardcoded-password",
          "severity": "critical",
          "category": "secrets",
          "title": "Hardcoded Password Detected",
          "description": "Passwords should never be hardcoded in source code. Store them securely in environment variables or secure credential stores.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/hardcoded-secret.js",
            "line": 6,
            "column": 8
          },
          "snippet": "     4 | \n     5 | const apiKey = \"fake_stripe_live_1234567890abcdefghijklmnop\";\n→    6 | const dbPassword = \"MySuperSecretPassword123!\";\n     7 | const API_KEY = \"fake_google_api_key_1234567890EXAMPLE\";\n     8 | ",
          "fix": {
            "recommendation": "Store passwords in environment variables (e.g., process.env.DB_PASSWORD) or use a secure credential management system",
            "before": "const dbPassword = \"MySuperSecretPassword123!\";",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "hardcoded-api-key-1762722082398-o4j8hbw6g",
          "rule": "hardcoded-api-key",
          "severity": "critical",
          "category": "secrets",
          "title": "Hardcoded API Key Detected",
          "description": "API keys should be stored in environment variables, not hardcoded in source code. Exposed credentials can be used by attackers to access your API.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/hardcoded-secret.js",
            "line": 5,
            "column": 6
          },
          "snippet": "     3 | // Note: These are FAKE keys for testing purposes only\n     4 | \n→    5 | const apiKey = \"fake_stripe_live_1234567890abcdefghijklmnop\";\n     6 | const dbPassword = \"MySuperSecretPassword123!\";\n     7 | const API_KEY = \"fake_google_api_key_1234567890EXAMPLE\";",
          "fix": {
            "recommendation": "Move the API key to an environment variable using process.env or equivalent",
            "before": "const apiKey = \"fake_stripe_live_1234567890abcdefghijklmnop\";",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "hardcoded-api-key-1762722082398-rxmrx4sd0",
          "rule": "hardcoded-api-key",
          "severity": "critical",
          "category": "secrets",
          "title": "Hardcoded API Key Detected",
          "description": "API keys should be stored in environment variables, not hardcoded in source code. Exposed credentials can be used by attackers to access your API.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/hardcoded-secret.js",
            "line": 7,
            "column": 6
          },
          "snippet": "     5 | const apiKey = \"fake_stripe_live_1234567890abcdefghijklmnop\";\n     6 | const dbPassword = \"MySuperSecretPassword123!\";\n→    7 | const API_KEY = \"fake_google_api_key_1234567890EXAMPLE\";\n     8 | \n     9 | module.exports = {",
          "fix": {
            "recommendation": "Move the API key to an environment variable using process.env or equivalent",
            "before": "const API_KEY = \"fake_google_api_key_1234567890EXAMPLE\";",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "hardcoded-api-key-1762722082398-of5qlp6l7",
          "rule": "hardcoded-api-key",
          "severity": "critical",
          "category": "secrets",
          "title": "Hardcoded API Key Detected",
          "description": "API keys should be stored in environment variables, not hardcoded in source code. Exposed credentials can be used by attackers to access your API.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/hardcoded-secret.js",
            "line": 5,
            "column": 16
          },
          "snippet": "     3 | // Note: These are FAKE keys for testing purposes only\n     4 | \n→    5 | const apiKey = \"fake_stripe_live_1234567890abcdefghijklmnop\";\n     6 | const dbPassword = \"MySuperSecretPassword123!\";\n     7 | const API_KEY = \"fake_google_api_key_1234567890EXAMPLE\";",
          "fix": {
            "recommendation": "Move the API key to an environment variable using process.env or equivalent",
            "before": "const apiKey = \"fake_stripe_live_1234567890abcdefghijklmnop\";",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "hardcoded-api-key-1762722082398-1zikyvnnd",
          "rule": "hardcoded-api-key",
          "severity": "critical",
          "category": "secrets",
          "title": "Hardcoded API Key Detected",
          "description": "API keys should be stored in environment variables, not hardcoded in source code. Exposed credentials can be used by attackers to access your API.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/hardcoded-secret.js",
            "line": 7,
            "column": 17
          },
          "snippet": "     5 | const apiKey = \"fake_stripe_live_1234567890abcdefghijklmnop\";\n     6 | const dbPassword = \"MySuperSecretPassword123!\";\n→    7 | const API_KEY = \"fake_google_api_key_1234567890EXAMPLE\";\n     8 | \n     9 | module.exports = {",
          "fix": {
            "recommendation": "Move the API key to an environment variable using process.env or equivalent",
            "before": "const API_KEY = \"fake_google_api_key_1234567890EXAMPLE\";",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "hardcoded-password-1762722082398-1du6tgkk4",
          "rule": "hardcoded-password",
          "severity": "critical",
          "category": "secrets",
          "title": "Hardcoded Password Detected",
          "description": "Passwords should never be hardcoded in source code. Store them securely in environment variables or secure credential stores.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/hardcoded-secret.js",
            "line": 6,
            "column": 8
          },
          "snippet": "     4 | \n     5 | const apiKey = \"fake_stripe_live_1234567890abcdefghijklmnop\";\n→    6 | const dbPassword = \"MySuperSecretPassword123!\";\n     7 | const API_KEY = \"fake_google_api_key_1234567890EXAMPLE\";\n     8 | ",
          "fix": {
            "recommendation": "Store passwords in environment variables (e.g., process.env.DB_PASSWORD) or use a secure credential management system",
            "before": "const dbPassword = \"MySuperSecretPassword123!\";",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        }
      ]
    ],
    [
      "84ea9d568f30e8aafba542343a18de6c680fbcbd",
      [
        {
          "id": "missing-csrf-flask-1762722082470-k81kmeuwx",
          "rule": "missing-csrf-flask",
          "severity": "high",
          "category": "web-security",
          "title": "Missing CSRF Protection (Flask)",
          "description": "Flask application without CSRF protection enabled",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/weak-auth.py",
            "line": 21,
            "column": 0
          },
          "snippet": "    19 | \n    20 | # Issue 2: Missing rate limiting on login endpoint\n→   21 | @app.route('/login', methods=['POST'])\n    22 | def login():\n    23 |     username = request.json.get('username')",
          "fix": {
            "recommendation": "Enable Flask-WTF CSRF protection.\n\nBefore:\nfrom flask import Flask\napp = Flask(__name__)\n\n@app.route('/transfer', methods=['POST'])\ndef transfer():\n    pass\n\nAfter:\nfrom flask import Flask\nfrom flask_wtf.csrf import CSRFProtect\n\napp = Flask(__name__)\napp.config['SECRET_KEY'] = os.environ.get('SECRET_KEY')\ncsrf = CSRFProtect(app)\n\n@app.route('/transfer', methods=['POST'])\ndef transfer():\n    pass  # CSRF automatically validated\n",
            "before": "@app.route('/login', methods=['POST'])",
            "after": "",
            "references": [
              "https://flask-wtf.readthedocs.io/en/stable/csrf.html",
              "https://cwe.mitre.org/data/definitions/352.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-352",
            "owasp": "A01:2021"
          }
        },
        {
          "id": "missing-csrf-flask-1762722082470-sz1c16k2w",
          "rule": "missing-csrf-flask",
          "severity": "high",
          "category": "web-security",
          "title": "Missing CSRF Protection (Flask)",
          "description": "Flask application without CSRF protection enabled",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/weak-auth.py",
            "line": 4,
            "column": 0
          },
          "snippet": "     2 | # Should trigger: weak-password-validation, missing-rate-limiting, insecure-session-config, missing-jwt-verification\n     3 | \n→    4 | from flask import Flask, request, jsonify, make_response\n     5 | import jwt\n     6 | ",
          "fix": {
            "recommendation": "Enable Flask-WTF CSRF protection.\n\nBefore:\nfrom flask import Flask\napp = Flask(__name__)\n\n@app.route('/transfer', methods=['POST'])\ndef transfer():\n    pass\n\nAfter:\nfrom flask import Flask\nfrom flask_wtf.csrf import CSRFProtect\n\napp = Flask(__name__)\napp.config['SECRET_KEY'] = os.environ.get('SECRET_KEY')\ncsrf = CSRFProtect(app)\n\n@app.route('/transfer', methods=['POST'])\ndef transfer():\n    pass  # CSRF automatically validated\n",
            "before": "from flask import Flask, request, jsonify, make_response",
            "after": "",
            "references": [
              "https://flask-wtf.readthedocs.io/en/stable/csrf.html",
              "https://cwe.mitre.org/data/definitions/352.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-352",
            "owasp": "A01:2021"
          }
        },
        {
          "id": "missing-x-frame-options-1762722082483-2zvz47u16",
          "rule": "missing-x-frame-options",
          "severity": "medium",
          "category": "web-security",
          "title": "Missing X-Frame-Options Header",
          "description": "Missing protection against clickjacking attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/weak-auth.py",
            "line": 7,
            "column": 6
          },
          "snippet": "     5 | import jwt\n     6 | \n→    7 | app = Flask(__name__)\n     8 | \n     9 | # Issue 1: Weak password validation",
          "fix": {
            "recommendation": "Add X-Frame-Options header to prevent clickjacking.\n\nBefore (Express):\nconst app = express();\n\nAfter (Express):\napp.use(helmet.frameguard({ action: 'deny' }));\n// Or: app.use((req, res, next) => {\n//   res.setHeader('X-Frame-Options', 'DENY');\n//   next();\n// });\n\nBefore (Flask):\n@app.route('/')\ndef index():\n    return render_template('index.html')\n\nAfter (Flask):\n@app.after_request\ndef set_security_headers(response):\n    response.headers['X-Frame-Options'] = 'DENY'\n    return response\n",
            "before": "app = Flask(__name__)",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#x-frame-options",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-1021",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "weak-password-validation-1762722082490-axjvij18x",
          "rule": "weak-password-validation",
          "severity": "high",
          "category": "auth",
          "title": "Weak Password Validation",
          "description": "Weak password requirements allow users to create easily guessable passwords, making accounts vulnerable to brute-force attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/weak-auth.py",
            "line": 12,
            "column": 7
          },
          "snippet": "    10 | def is_valid_password(password):\n    11 |     # Only checking length - too weak!\n→   12 |     if len(password) < 6:\n    13 |         return False\n    14 |     return True",
          "fix": {
            "recommendation": "Implement strong password requirements: minimum 12 characters, mix of uppercase, lowercase, numbers, and special characters\n\nBefore:\nif (password.length < 6) { return false; }\n\nAfter:\nif (password.length < 12 || \n    !/[A-Z]/.test(password) || \n    !/[a-z]/.test(password) || \n    !/[0-9]/.test(password) || \n    !/[^A-Za-z0-9]/.test(password)) {\n  return false;\n}\n",
            "before": "if len(password) < 6:",
            "after": "",
            "references": [
              "https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/04-Authentication_Testing/07-Testing_for_Weak_Password_Policy",
              "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-521",
            "owasp": "OWASP A7:2021"
          }
        },
        {
          "id": "missing-rate-limiting-1762722082490-chrpaye14",
          "rule": "missing-rate-limiting",
          "severity": "critical",
          "category": "auth",
          "title": "Missing Rate Limiting on Authentication",
          "description": "Without rate limiting, attackers can attempt unlimited authentication attempts, enabling brute-force and credential stuffing attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/weak-auth.py",
            "line": 22,
            "column": 0
          },
          "snippet": "    20 | # Issue 2: Missing rate limiting on login endpoint\n    21 | @app.route('/login', methods=['POST'])\n→   22 | def login():\n    23 |     username = request.json.get('username')\n    24 |     password = request.json.get('password')",
          "fix": {
            "recommendation": "Implement rate limiting on authentication endpoints using middleware or decorators\n\nBefore:\napp.post('/login', async (req, res) => {\n  const user = await authenticate(req.body);\n});\n\nAfter:\nconst rateLimit = require('express-rate-limit');\nconst loginLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000, // 15 minutes\n  max: 5, // limit each IP to 5 requests per windowMs\n  message: 'Too many login attempts, please try again later'\n});\n\napp.post('/login', loginLimiter, async (req, res) => {\n  const user = await authenticate(req.body);\n});\n",
            "before": "def login():",
            "after": "",
            "references": [
              "https://owasp.org/www-community/controls/Blocking_Brute_Force_Attacks",
              "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-307",
            "owasp": "OWASP A7:2021"
          }
        },
        {
          "id": "insecure-session-config-1762722082491-a1ho0y9rn",
          "rule": "insecure-session-config",
          "severity": "high",
          "category": "auth",
          "title": "Insecure Session Configuration",
          "description": "Sessions without security flags are vulnerable to XSS attacks (no httpOnly), interception (no secure), and CSRF attacks (no sameSite)",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/weak-auth.py",
            "line": 35,
            "column": 21
          },
          "snippet": "    33 |         \n    34 |         # Issue 3: Insecure session configuration\n→   35 |         response.set_cookie('sessionId', user.session_token)\n    36 |         # Missing: httponly=True, secure=True, samesite='Strict'\n    37 |         ",
          "fix": {
            "recommendation": "Always set httpOnly, secure, and sameSite flags on session cookies\n\nBefore:\nres.cookie('sessionId', token);\n\nAfter:\nres.cookie('sessionId', token, {\n  httpOnly: true,    // Prevents JavaScript access\n  secure: true,      // HTTPS only\n  sameSite: 'strict' // CSRF protection\n});\n\nPython/Flask:\napp.config['SESSION_COOKIE_HTTPONLY'] = True\napp.config['SESSION_COOKIE_SECURE'] = True\napp.config['SESSION_COOKIE_SAMESITE'] = 'Strict'\n",
            "before": "response.set_cookie('sessionId', user.session_token)",
            "after": "",
            "references": [
              "https://owasp.org/www-community/controls/SecureCookieAttribute",
              "https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-614",
            "owasp": "OWASP A5:2021"
          }
        },
        {
          "id": "insecure-session-config-1762722082491-8sgykue37",
          "rule": "insecure-session-config",
          "severity": "high",
          "category": "auth",
          "title": "Insecure Session Configuration",
          "description": "Sessions without security flags are vulnerable to XSS attacks (no httpOnly), interception (no secure), and CSRF attacks (no sameSite)",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/weak-auth.py",
            "line": 35,
            "column": 17
          },
          "snippet": "    33 |         \n    34 |         # Issue 3: Insecure session configuration\n→   35 |         response.set_cookie('sessionId', user.session_token)\n    36 |         # Missing: httponly=True, secure=True, samesite='Strict'\n    37 |         ",
          "fix": {
            "recommendation": "Always set httpOnly, secure, and sameSite flags on session cookies\n\nBefore:\nres.cookie('sessionId', token);\n\nAfter:\nres.cookie('sessionId', token, {\n  httpOnly: true,    // Prevents JavaScript access\n  secure: true,      // HTTPS only\n  sameSite: 'strict' // CSRF protection\n});\n\nPython/Flask:\napp.config['SESSION_COOKIE_HTTPONLY'] = True\napp.config['SESSION_COOKIE_SECURE'] = True\napp.config['SESSION_COOKIE_SAMESITE'] = 'Strict'\n",
            "before": "response.set_cookie('sessionId', user.session_token)",
            "after": "",
            "references": [
              "https://owasp.org/www-community/controls/SecureCookieAttribute",
              "https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-614",
            "owasp": "OWASP A5:2021"
          }
        },
        {
          "id": "missing-jwt-verification-1762722082491-l6rjw5zby",
          "rule": "missing-jwt-verification",
          "severity": "critical",
          "category": "auth",
          "title": "JWT Token Used Without Verification",
          "description": "Unverified JWT tokens can be forged by attackers, allowing authentication bypass and privilege escalation",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/weak-auth.py",
            "line": 39,
            "column": 21
          },
          "snippet": "    37 |         \n    38 |         # Issue 4: JWT decoded without verification\n→   39 |         token_data = jwt.decode(user.token, verify=False)\n    40 |         \n    41 |         return response",
          "fix": {
            "recommendation": "Always verify JWT signatures and validate claims\n\nBefore:\nconst decoded = jwt.decode(token);\n// OR\ndecoded = jwt.decode(token, verify=False)\n\nAfter:\nconst decoded = jwt.verify(token, SECRET_KEY, {\n  algorithms: ['HS256'],\n  issuer: 'your-app',\n  audience: 'your-api'\n});\n\nPython:\ndecoded = jwt.decode(\n  token, \n  SECRET_KEY, \n  algorithms=['HS256'],\n  verify=True,\n  audience='your-api'\n)\n",
            "before": "token_data = jwt.decode(user.token, verify=False)",
            "after": "",
            "references": [
              "https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/",
              "https://cheatsheetseries.owasp.org/cheatsheets/JSON_Web_Token_for_Java_Cheat_Sheet.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-347",
            "owasp": "OWASP A2:2021"
          }
        },
        {
          "id": "missing-jwt-verification-1762722082491-l8e2b7k2h",
          "rule": "missing-jwt-verification",
          "severity": "critical",
          "category": "auth",
          "title": "JWT Token Used Without Verification",
          "description": "Unverified JWT tokens can be forged by attackers, allowing authentication bypass and privilege escalation",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/weak-auth.py",
            "line": 39,
            "column": 21
          },
          "snippet": "    37 |         \n    38 |         # Issue 4: JWT decoded without verification\n→   39 |         token_data = jwt.decode(user.token, verify=False)\n    40 |         \n    41 |         return response",
          "fix": {
            "recommendation": "Always verify JWT signatures and validate claims\n\nBefore:\nconst decoded = jwt.decode(token);\n// OR\ndecoded = jwt.decode(token, verify=False)\n\nAfter:\nconst decoded = jwt.verify(token, SECRET_KEY, {\n  algorithms: ['HS256'],\n  issuer: 'your-app',\n  audience: 'your-api'\n});\n\nPython:\ndecoded = jwt.decode(\n  token, \n  SECRET_KEY, \n  algorithms=['HS256'],\n  verify=True,\n  audience='your-api'\n)\n",
            "before": "token_data = jwt.decode(user.token, verify=False)",
            "after": "",
            "references": [
              "https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/",
              "https://cheatsheetseries.owasp.org/cheatsheets/JSON_Web_Token_for_Java_Cheat_Sheet.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-347",
            "owasp": "OWASP A2:2021"
          }
        }
      ]
    ],
    [
      "588de930f745289867e552c7be743438ac6d9b0d",
      [
        {
          "id": "missing-csrf-flask-1762722082493-k4xq4x7eh",
          "rule": "missing-csrf-flask",
          "severity": "high",
          "category": "web-security",
          "title": "Missing CSRF Protection (Flask)",
          "description": "Flask application without CSRF protection enabled",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/error-handler.py",
            "line": 4,
            "column": 0
          },
          "snippet": "     2 | # Will need AI-specific rules (not yet created)\n     3 | \n→    4 | from flask import Flask\n     5 | \n     6 | app = Flask(__name__)",
          "fix": {
            "recommendation": "Enable Flask-WTF CSRF protection.\n\nBefore:\nfrom flask import Flask\napp = Flask(__name__)\n\n@app.route('/transfer', methods=['POST'])\ndef transfer():\n    pass\n\nAfter:\nfrom flask import Flask\nfrom flask_wtf.csrf import CSRFProtect\n\napp = Flask(__name__)\napp.config['SECRET_KEY'] = os.environ.get('SECRET_KEY')\ncsrf = CSRFProtect(app)\n\n@app.route('/transfer', methods=['POST'])\ndef transfer():\n    pass  # CSRF automatically validated\n",
            "before": "from flask import Flask",
            "after": "",
            "references": [
              "https://flask-wtf.readthedocs.io/en/stable/csrf.html",
              "https://cwe.mitre.org/data/definitions/352.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-352",
            "owasp": "A01:2021"
          }
        }
      ]
    ],
    [
      "08dbb906582dcc013f8eca82f2f61817d74e5c8e",
      [
        {
          "id": "ast-sql-injection-1762722082496-ahbc7g9al",
          "rule": "ast-sql-injection",
          "severity": "critical",
          "category": "injection",
          "title": "SQL Injection Detected",
          "description": "SQL injection vulnerabilities detected in query construction",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/command-injection.js",
            "line": 7,
            "column": 7
          },
          "snippet": "     5 | \n     6 | function pingHost(host) {\n→    7 |   exec(`ping -c 1 ${host}`, (err, stdout) => {\n     8 |     console.log(stdout);\n     9 |   });",
          "fix": {
            "recommendation": "Use parameterized queries or prepared statements instead of string concatenation",
            "before": "exec(`ping -c 1 ${host}`, (err, stdout) => {",
            "after": "",
            "references": [
              "https://owasp.org/www-community/attacks/SQL_Injection",
              "https://cwe.mitre.org/data/definitions/89.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-89",
            "owasp": "A03:2021"
          }
        },
        {
          "id": "ast-sql-injection-1762722082496-2vx8kw44i",
          "rule": "ast-sql-injection",
          "severity": "critical",
          "category": "injection",
          "title": "SQL Injection Detected",
          "description": "SQL injection vulnerabilities detected in query construction",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/command-injection.js",
            "line": 13,
            "column": 26
          },
          "snippet": "    11 | \n    12 | function processFile(filename) {\n→   13 |   const result = execSync(`cat ${filename}`);\n    14 |   return result.toString();\n    15 | }",
          "fix": {
            "recommendation": "Use parameterized queries or prepared statements instead of string concatenation",
            "before": "const result = execSync(`cat ${filename}`);",
            "after": "",
            "references": [
              "https://owasp.org/www-community/attacks/SQL_Injection",
              "https://cwe.mitre.org/data/definitions/89.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-89",
            "owasp": "A03:2021"
          }
        },
        {
          "id": "command-injection-1762722082503-5pjz4mjqr",
          "rule": "command-injection",
          "severity": "critical",
          "category": "injection",
          "title": "Command Injection Vulnerability",
          "description": "User input is passed to system commands without validation, allowing arbitrary command execution",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/command-injection.js",
            "line": 13,
            "column": 17
          },
          "snippet": "    11 | \n    12 | function processFile(filename) {\n→   13 |   const result = execSync(`cat ${filename}`);\n    14 |   return result.toString();\n    15 | }",
          "fix": {
            "recommendation": "Avoid passing user input to system commands. If necessary, use allowlists and strict input validation.",
            "before": "const result = execSync(`cat ${filename}`);",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A1_2017-Injection",
              "https://cwe.mitre.org/data/definitions/78.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-78",
            "owasp": "A1:2017"
          }
        },
        {
          "id": "command-injection-exec-1762722082504-pq3d0bb5c",
          "rule": "command-injection-exec",
          "severity": "critical",
          "category": "injection",
          "title": "Command Injection via exec/spawn",
          "description": "User input is passed directly to shell commands, allowing attackers to execute arbitrary commands",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/command-injection.js",
            "line": 7,
            "column": 2
          },
          "snippet": "     5 | \n     6 | function pingHost(host) {\n→    7 |   exec(`ping -c 1 ${host}`, (err, stdout) => {\n     8 |     console.log(stdout);\n     9 |   });",
          "fix": {
            "recommendation": "Use parameterized commands or sanitize input. Never concatenate user input into shell commands.\n\nBefore:\nexec(`git clone ${userRepo}`);\n\nAfter:\nconst { execFile } = require('child_process');\nexecFile('git', ['clone', userRepo]);\n",
            "before": "exec(`ping -c 1 ${host}`, (err, stdout) => {",
            "after": "",
            "references": [
              "https://owasp.org/www-community/attacks/Command_Injection",
              "https://cwe.mitre.org/data/definitions/78.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-78",
            "owasp": "A03:2021"
          }
        },
        {
          "id": "command-injection-exec-1762722082504-fmrfa053t",
          "rule": "command-injection-exec",
          "severity": "critical",
          "category": "injection",
          "title": "Command Injection via exec/spawn",
          "description": "User input is passed directly to shell commands, allowing attackers to execute arbitrary commands",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/command-injection.js",
            "line": 13,
            "column": 17
          },
          "snippet": "    11 | \n    12 | function processFile(filename) {\n→   13 |   const result = execSync(`cat ${filename}`);\n    14 |   return result.toString();\n    15 | }",
          "fix": {
            "recommendation": "Use parameterized commands or sanitize input. Never concatenate user input into shell commands.\n\nBefore:\nexec(`git clone ${userRepo}`);\n\nAfter:\nconst { execFile } = require('child_process');\nexecFile('git', ['clone', userRepo]);\n",
            "before": "const result = execSync(`cat ${filename}`);",
            "after": "",
            "references": [
              "https://owasp.org/www-community/attacks/Command_Injection",
              "https://cwe.mitre.org/data/definitions/78.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-78",
            "owasp": "A03:2021"
          }
        }
      ]
    ],
    [
      "baf6050143cd2efe5fc67a499add272c78a67e67",
      [
        {
          "id": "ast-sql-injection-1762722082506-wl4r9i7rj",
          "rule": "ast-sql-injection",
          "severity": "critical",
          "category": "injection",
          "title": "SQL Injection Detected",
          "description": "SQL injection vulnerabilities detected in query construction",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/xss.js",
            "line": 8,
            "column": 11
          },
          "snippet": "     6 | \n     7 | app.get('/search', (req, res) => {\n→    8 |   res.send(`<h1>Results for: ${req.query.term}</h1>`);\n     9 | });\n    10 | ",
          "fix": {
            "recommendation": "Use parameterized queries or prepared statements instead of string concatenation",
            "before": "res.send(`<h1>Results for: ${req.query.term}</h1>`);",
            "after": "",
            "references": [
              "https://owasp.org/www-community/attacks/SQL_Injection",
              "https://cwe.mitre.org/data/definitions/89.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-89",
            "owasp": "A03:2021"
          }
        },
        {
          "id": "ast-sql-injection-1762722082506-0o10qjs98",
          "rule": "ast-sql-injection",
          "severity": "critical",
          "category": "injection",
          "title": "SQL Injection Detected",
          "description": "SQL injection vulnerabilities detected in query construction",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/xss.js",
            "line": 13,
            "column": 46
          },
          "snippet": "    11 | app.get('/profile', (req, res) => {\n    12 |   const username = req.query.name;\n→   13 |   document.getElementById('user').innerHTML = `Welcome ${username}`;\n    14 | });\n    15 | ",
          "fix": {
            "recommendation": "Use parameterized queries or prepared statements instead of string concatenation",
            "before": "document.getElementById('user').innerHTML = `Welcome ${username}`;",
            "after": "",
            "references": [
              "https://owasp.org/www-community/attacks/SQL_Injection",
              "https://cwe.mitre.org/data/definitions/89.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-89",
            "owasp": "A03:2021"
          }
        },
        {
          "id": "xss-vulnerability-1762722082509-fb76s3ybx",
          "rule": "xss-vulnerability",
          "severity": "high",
          "category": "injection",
          "title": "Cross-Site Scripting (XSS) Vulnerability",
          "description": "User input is rendered directly into HTML without sanitization, allowing attackers to inject malicious scripts",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/xss.js",
            "line": 8,
            "column": 2
          },
          "snippet": "     6 | \n     7 | app.get('/search', (req, res) => {\n→    8 |   res.send(`<h1>Results for: ${req.query.term}</h1>`);\n     9 | });\n    10 | ",
          "fix": {
            "recommendation": "Sanitize user input before rendering. Use templating engines with auto-escaping or sanitization libraries like DOMPurify.",
            "before": "res.send(`<h1>Results for: ${req.query.term}</h1>`);",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)",
              "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html",
              "https://cwe.mitre.org/data/definitions/79.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-79",
            "owasp": "A7:2017"
          }
        },
        {
          "id": "xss-vulnerability-1762722082509-y9iiemo46",
          "rule": "xss-vulnerability",
          "severity": "high",
          "category": "injection",
          "title": "Cross-Site Scripting (XSS) Vulnerability",
          "description": "User input is rendered directly into HTML without sanitization, allowing attackers to inject malicious scripts",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/xss.js",
            "line": 13,
            "column": 34
          },
          "snippet": "    11 | app.get('/profile', (req, res) => {\n    12 |   const username = req.query.name;\n→   13 |   document.getElementById('user').innerHTML = `Welcome ${username}`;\n    14 | });\n    15 | ",
          "fix": {
            "recommendation": "Sanitize user input before rendering. Use templating engines with auto-escaping or sanitization libraries like DOMPurify.",
            "before": "document.getElementById('user').innerHTML = `Welcome ${username}`;",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)",
              "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html",
              "https://cwe.mitre.org/data/definitions/79.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-79",
            "owasp": "A7:2017"
          }
        },
        {
          "id": "missing-csp-header-1762722082510-762gtltni",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/xss.js",
            "line": 7,
            "column": 0
          },
          "snippet": "     5 | const app = express();\n     6 | \n→    7 | app.get('/search', (req, res) => {\n     8 |   res.send(`<h1>Results for: ${req.query.term}</h1>`);\n     9 | });",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "app.get('/search', (req, res) => {",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-csp-header-1762722082510-gt8mihc9h",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/xss.js",
            "line": 11,
            "column": 0
          },
          "snippet": "     9 | });\n    10 | \n→   11 | app.get('/profile', (req, res) => {\n    12 |   const username = req.query.name;\n    13 |   document.getElementById('user').innerHTML = `Welcome ${username}`;",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "app.get('/profile', (req, res) => {",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-csp-header-1762722082510-klee6zvxb",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/xss.js",
            "line": 5,
            "column": 12
          },
          "snippet": "     3 | \n     4 | const express = require('express');\n→    5 | const app = express();\n     6 | \n     7 | app.get('/search', (req, res) => {",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "x-powered-by-header-1762722082510-kc7a2vq5o",
          "rule": "x-powered-by-header",
          "severity": "low",
          "category": "headers",
          "title": "X-Powered-By Header Exposure",
          "description": "X-Powered-By header reveals technology stack information",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/xss.js",
            "line": 5,
            "column": 12
          },
          "snippet": "     3 | \n     4 | const express = require('express');\n→    5 | const app = express();\n     6 | \n     7 | app.get('/search', (req, res) => {",
          "fix": {
            "recommendation": "Remove or disable X-Powered-By header.\n\nBefore:\nconst app = express();\n\nAfter:\nconst app = express();\napp.disable('x-powered-by');\n\n// Or use helmet:\napp.use(helmet.hidePoweredBy());\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/",
              "https://expressjs.com/en/advanced/best-practice-security.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-200",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-content-security-policy-1762722082511-9z75ek2mt",
          "rule": "missing-content-security-policy",
          "severity": "high",
          "category": "web-security",
          "title": "Missing Content-Security-Policy Header",
          "description": "CSP header missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/xss.js",
            "line": 5,
            "column": 12
          },
          "snippet": "     3 | \n     4 | const express = require('express');\n→    5 | const app = express();\n     6 | \n     7 | app.get('/search', (req, res) => {",
          "fix": {
            "recommendation": "Add Content-Security-Policy header using helmet middleware.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n  }\n}));\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#content-security-policy",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-x-content-type-options-1762722082511-z3fkdg7ns",
          "rule": "missing-x-content-type-options",
          "severity": "low",
          "category": "web-security",
          "title": "Missing X-Content-Type-Options Header",
          "description": "Missing protection against MIME type sniffing attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/xss.js",
            "line": 8,
            "column": 2
          },
          "snippet": "     6 | \n     7 | app.get('/search', (req, res) => {\n→    8 |   res.send(`<h1>Results for: ${req.query.term}</h1>`);\n     9 | });\n    10 | ",
          "fix": {
            "recommendation": "Add X-Content-Type-Options header to prevent MIME sniffing.\n\nBefore:\nres.send(html);\n\nAfter:\napp.use(helmet.noSniff());\n// Or: res.setHeader('X-Content-Type-Options', 'nosniff');\nres.send(html);\n",
            "before": "res.send(`<h1>Results for: ${req.query.term}</h1>`);",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#x-content-type-options",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-430",
            "owasp": "A05:2021"
          }
        }
      ]
    ],
    [
      "55574b42b74eacf234246d447954c30e0c0a92ee",
      [
        {
          "id": "missing-csrf-flask-1762722082525-gsd4o0duf",
          "rule": "missing-csrf-flask",
          "severity": "high",
          "category": "web-security",
          "title": "Missing CSRF Protection (Flask)",
          "description": "Flask application without CSRF protection enabled",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/ai-security.py",
            "line": 35,
            "column": 0
          },
          "snippet": "    33 |     return jsonify(users)\n    34 | \n→   35 | @app.route('/admin/config', methods=['POST'])\n    36 | def update_admin_config():\n    37 |     config = request.json",
          "fix": {
            "recommendation": "Enable Flask-WTF CSRF protection.\n\nBefore:\nfrom flask import Flask\napp = Flask(__name__)\n\n@app.route('/transfer', methods=['POST'])\ndef transfer():\n    pass\n\nAfter:\nfrom flask import Flask\nfrom flask_wtf.csrf import CSRFProtect\n\napp = Flask(__name__)\napp.config['SECRET_KEY'] = os.environ.get('SECRET_KEY')\ncsrf = CSRFProtect(app)\n\n@app.route('/transfer', methods=['POST'])\ndef transfer():\n    pass  # CSRF automatically validated\n",
            "before": "@app.route('/admin/config', methods=['POST'])",
            "after": "",
            "references": [
              "https://flask-wtf.readthedocs.io/en/stable/csrf.html",
              "https://cwe.mitre.org/data/definitions/352.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-352",
            "owasp": "A01:2021"
          }
        },
        {
          "id": "missing-csrf-flask-1762722082525-duyuwp51n",
          "rule": "missing-csrf-flask",
          "severity": "high",
          "category": "web-security",
          "title": "Missing CSRF Protection (Flask)",
          "description": "Flask application without CSRF protection enabled",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/ai-security.py",
            "line": 4,
            "column": 0
          },
          "snippet": "     2 | # This file contains common vulnerabilities in AI-generated Flask/FastAPI code\n     3 | \n→    4 | from flask import Flask, jsonify, request, Response\n     5 | from flask_cors import CORS, cross_origin\n     6 | import traceback",
          "fix": {
            "recommendation": "Enable Flask-WTF CSRF protection.\n\nBefore:\nfrom flask import Flask\napp = Flask(__name__)\n\n@app.route('/transfer', methods=['POST'])\ndef transfer():\n    pass\n\nAfter:\nfrom flask import Flask\nfrom flask_wtf.csrf import CSRFProtect\n\napp = Flask(__name__)\napp.config['SECRET_KEY'] = os.environ.get('SECRET_KEY')\ncsrf = CSRFProtect(app)\n\n@app.route('/transfer', methods=['POST'])\ndef transfer():\n    pass  # CSRF automatically validated\n",
            "before": "from flask import Flask, jsonify, request, Response",
            "after": "",
            "references": [
              "https://flask-wtf.readthedocs.io/en/stable/csrf.html",
              "https://cwe.mitre.org/data/definitions/352.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-352",
            "owasp": "A01:2021"
          }
        },
        {
          "id": "permissive-cors-1762722082526-6ay1yq1cg",
          "rule": "permissive-cors",
          "severity": "high",
          "category": "ai-specific",
          "title": "Overly Permissive CORS Configuration",
          "description": "Allowing all origins enables any website to make requests to your API, potentially exposing sensitive data or enabling CSRF attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/ai-security.py",
            "line": 58,
            "column": 0
          },
          "snippet": "    56 | # Another CORS vulnerability pattern\n    57 | @app.route('/api/public')\n→   58 | @cross_origin(origins='*')\n    59 | def public_api():\n    60 |     return jsonify({'data': 'public'})",
          "fix": {
            "recommendation": "Restrict CORS to specific trusted origins\n\nBefore:\nres.setHeader('Access-Control-Allow-Origin', '*');\n// OR\napp.use(cors({ origin: '*' }));\n\nAfter:\nconst allowedOrigins = ['https://app.example.com', 'https://admin.example.com'];\napp.use(cors({\n  origin: (origin, callback) => {\n    if (!origin || allowedOrigins.includes(origin)) {\n      callback(null, true);\n    } else {\n      callback(new Error('Not allowed by CORS'));\n    }\n  }\n}));\n",
            "before": "@cross_origin(origins='*')",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS",
              "https://owasp.org/www-community/attacks/CORS_OriginHeaderScrutiny"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-942",
            "owasp": "OWASP A5:2021"
          }
        },
        {
          "id": "permissive-cors-1762722082526-8bkrhzp3f",
          "rule": "permissive-cors",
          "severity": "high",
          "category": "ai-specific",
          "title": "Overly Permissive CORS Configuration",
          "description": "Allowing all origins enables any website to make requests to your API, potentially exposing sensitive data or enabling CSRF attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/ai-security.py",
            "line": 11,
            "column": 0
          },
          "snippet": "     9 | \n    10 | # VULNERABILITY 1: Overly permissive CORS (permissive-cors)\n→   11 | CORS(app, allow_origins=['*'], supports_credentials=True)\n    12 | \n    13 | # VULNERABILITY 2: Debug mode enabled (debug-mode-enabled)",
          "fix": {
            "recommendation": "Restrict CORS to specific trusted origins\n\nBefore:\nres.setHeader('Access-Control-Allow-Origin', '*');\n// OR\napp.use(cors({ origin: '*' }));\n\nAfter:\nconst allowedOrigins = ['https://app.example.com', 'https://admin.example.com'];\napp.use(cors({\n  origin: (origin, callback) => {\n    if (!origin || allowedOrigins.includes(origin)) {\n      callback(null, true);\n    } else {\n      callback(new Error('Not allowed by CORS'));\n    }\n  }\n}));\n",
            "before": "CORS(app, allow_origins=['*'], supports_credentials=True)",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS",
              "https://owasp.org/www-community/attacks/CORS_OriginHeaderScrutiny"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-942",
            "owasp": "OWASP A5:2021"
          }
        },
        {
          "id": "verbose-error-response-1762722082526-04z6jko1f",
          "rule": "verbose-error-response",
          "severity": "high",
          "category": "ai-specific",
          "title": "Verbose Error Messages Expose System Details",
          "description": "Exposing stack traces and error details reveals system architecture, file paths, and dependencies, helping attackers plan targeted attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/ai-security.py",
            "line": 54,
            "column": 8
          },
          "snippet": "    52 |     except Exception as e:\n    53 |         # Exposing error details\n→   54 |         return Response(str(e.__traceback__), status=500)\n    55 | \n    56 | # Another CORS vulnerability pattern",
          "fix": {
            "recommendation": "Log detailed errors server-side, return generic messages to clients\n\nBefore:\napp.use((err, req, res, next) => {\n  res.status(500).json({ error: err.stack });\n});\n\nAfter:\napp.use((err, req, res, next) => {\n  logger.error('Server error', { \n    error: err.message, \n    stack: err.stack,\n    path: req.path \n  });\n  \n  res.status(500).json({ \n    error: 'Internal server error',\n    requestId: req.id // for support reference\n  });\n});\n",
            "before": "return Response(str(e.__traceback__), status=500)",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/209.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-209",
            "owasp": "OWASP A3:2017"
          }
        },
        {
          "id": "debug-mode-enabled-1762722082526-ryxtg6lqr",
          "rule": "debug-mode-enabled",
          "severity": "critical",
          "category": "ai-specific",
          "title": "Debug Mode Enabled in Production",
          "description": "Debug mode exposes detailed error messages, enables hot-reloading, disables security features, and may leak sensitive configuration",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/ai-security.py",
            "line": 14,
            "column": 0
          },
          "snippet": "    12 | \n    13 | # VULNERABILITY 2: Debug mode enabled (debug-mode-enabled)\n→   14 | DEBUG = True\n    15 | \n    16 | # Alternative debug mode",
          "fix": {
            "recommendation": "Always disable debug mode in production\n\nBefore:\napp.run(debug=True)\n// OR\nconst app = express();\napp.use(morgan('dev'));\n\nAfter:\nconst isProduction = process.env.NODE_ENV === 'production';\napp.run(debug=!isProduction)\n\n// OR use environment variables\nif (process.env.NODE_ENV === 'production') {\n  app.use(morgan('combined'));\n}\n",
            "before": "DEBUG = True",
            "after": "",
            "references": [
              "https://flask.palletsprojects.com/en/2.0.x/config/#DEBUG",
              "https://expressjs.com/en/advanced/best-practice-performance.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-489",
            "owasp": "OWASP A6:2021"
          }
        },
        {
          "id": "debug-mode-enabled-1762722082527-fu5mklrc4",
          "rule": "debug-mode-enabled",
          "severity": "critical",
          "category": "ai-specific",
          "title": "Debug Mode Enabled in Production",
          "description": "Debug mode exposes detailed error messages, enables hot-reloading, disables security features, and may leak sensitive configuration",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/ai-security.py",
            "line": 64,
            "column": 4
          },
          "snippet": "    62 | # Running with debug mode\n    63 | if __name__ == '__main__':\n→   64 |     app.run(debug=True, host='0.0.0.0')\n    65 | ",
          "fix": {
            "recommendation": "Always disable debug mode in production\n\nBefore:\napp.run(debug=True)\n// OR\nconst app = express();\napp.use(morgan('dev'));\n\nAfter:\nconst isProduction = process.env.NODE_ENV === 'production';\napp.run(debug=!isProduction)\n\n// OR use environment variables\nif (process.env.NODE_ENV === 'production') {\n  app.use(morgan('combined'));\n}\n",
            "before": "app.run(debug=True, host='0.0.0.0')",
            "after": "",
            "references": [
              "https://flask.palletsprojects.com/en/2.0.x/config/#DEBUG",
              "https://expressjs.com/en/advanced/best-practice-performance.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-489",
            "owasp": "OWASP A6:2021"
          }
        }
      ]
    ],
    [
      "a7fcafe622e7fd422e1aa2be966869193584ca53",
      [
        {
          "id": "missing-csp-header-1762722082572-jtp00f163",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/cors.js",
            "line": 8,
            "column": 0
          },
          "snippet": "     6 | const app = express();\n     7 | \n→    8 | app.use(cors({\n     9 |   origin: '*',\n    10 |   credentials: true",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "app.use(cors({",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-csp-header-1762722082611-6bw4kbi0c",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/cors.js",
            "line": 13,
            "column": 0
          },
          "snippet": "    11 | }));\n    12 | \n→   13 | app.get('/api/data', (req, res) => {\n    14 |   res.json({ secret: 'data' });\n    15 | });",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "app.get('/api/data', (req, res) => {",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-csp-header-1762722082611-jrf4jevot",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/cors.js",
            "line": 6,
            "column": 12
          },
          "snippet": "     4 | const express = require('express');\n     5 | const cors = require('cors');\n→    6 | const app = express();\n     7 | \n     8 | app.use(cors({",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-x-frame-options-1762722082611-i322auvd6",
          "rule": "missing-x-frame-options",
          "severity": "medium",
          "category": "headers",
          "title": "Missing X-Frame-Options Header",
          "description": "Missing clickjacking protection header",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/cors.js",
            "line": 8,
            "column": 0
          },
          "snippet": "     6 | const app = express();\n     7 | \n→    8 | app.use(cors({\n     9 |   origin: '*',\n    10 |   credentials: true",
          "fix": {
            "recommendation": "Add X-Frame-Options header to prevent clickjacking.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.frameguard({ action: 'deny' }));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader('X-Frame-Options', 'DENY');\n  // Or: res.setHeader('X-Frame-Options', 'SAMEORIGIN');\n  next();\n});\n",
            "before": "app.use(cors({",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options",
              "https://owasp.org/www-project-secure-headers/#x-frame-options"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-1021",
            "owasp": "A04:2021"
          }
        },
        {
          "id": "missing-x-content-type-options-1762722082611-4rtr4dru2",
          "rule": "missing-x-content-type-options",
          "severity": "medium",
          "category": "headers",
          "title": "Missing X-Content-Type-Options Header",
          "description": "Missing MIME type sniffing protection",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/cors.js",
            "line": 8,
            "column": 0
          },
          "snippet": "     6 | const app = express();\n     7 | \n→    8 | app.use(cors({\n     9 |   origin: '*',\n    10 |   credentials: true",
          "fix": {
            "recommendation": "Add X-Content-Type-Options header to prevent MIME sniffing.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.noSniff());\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader('X-Content-Type-Options', 'nosniff');\n  next();\n});\n",
            "before": "app.use(cors({",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options",
              "https://owasp.org/www-project-secure-headers/#x-content-type-options"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-referrer-policy-1762722082611-gh41s4faa",
          "rule": "missing-referrer-policy",
          "severity": "low",
          "category": "headers",
          "title": "Missing Referrer-Policy Header",
          "description": "Referrer-Policy header missing, potentially leaking sensitive information",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/cors.js",
            "line": 8,
            "column": 0
          },
          "snippet": "     6 | const app = express();\n     7 | \n→    8 | app.use(cors({\n     9 |   origin: '*',\n    10 |   credentials: true",
          "fix": {
            "recommendation": "Add Referrer-Policy header to control referrer information.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.referrerPolicy({ policy: 'strict-origin-when-cross-origin' }));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader('Referrer-Policy', 'strict-origin-when-cross-origin');\n  next();\n});\n",
            "before": "app.use(cors({",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy",
              "https://owasp.org/www-project-secure-headers/#referrer-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-200",
            "owasp": "A01:2021"
          }
        },
        {
          "id": "missing-permissions-policy-1762722082611-st0gi1ahr",
          "rule": "missing-permissions-policy",
          "severity": "low",
          "category": "headers",
          "title": "Missing Permissions-Policy Header",
          "description": "Permissions-Policy (formerly Feature-Policy) header missing",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/cors.js",
            "line": 8,
            "column": 0
          },
          "snippet": "     6 | const app = express();\n     7 | \n→    8 | app.use(cors({\n     9 |   origin: '*',\n    10 |   credentials: true",
          "fix": {
            "recommendation": "Add Permissions-Policy header to control browser features.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.permittedCrossDomainPolicies());\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Permissions-Policy',\n    'geolocation=(), microphone=(), camera=()'\n  );\n  next();\n});\n",
            "before": "app.use(cors({",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Permissions-Policy",
              "https://owasp.org/www-project-secure-headers/#permissions-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "x-powered-by-header-1762722082611-ixy7644en",
          "rule": "x-powered-by-header",
          "severity": "low",
          "category": "headers",
          "title": "X-Powered-By Header Exposure",
          "description": "X-Powered-By header reveals technology stack information",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/cors.js",
            "line": 6,
            "column": 12
          },
          "snippet": "     4 | const express = require('express');\n     5 | const cors = require('cors');\n→    6 | const app = express();\n     7 | \n     8 | app.use(cors({",
          "fix": {
            "recommendation": "Remove or disable X-Powered-By header.\n\nBefore:\nconst app = express();\n\nAfter:\nconst app = express();\napp.disable('x-powered-by');\n\n// Or use helmet:\napp.use(helmet.hidePoweredBy());\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/",
              "https://expressjs.com/en/advanced/best-practice-security.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-200",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-content-security-policy-1762722082612-4vpipcczl",
          "rule": "missing-content-security-policy",
          "severity": "high",
          "category": "web-security",
          "title": "Missing Content-Security-Policy Header",
          "description": "CSP header missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/cors.js",
            "line": 8,
            "column": 0
          },
          "snippet": "     6 | const app = express();\n     7 | \n→    8 | app.use(cors({\n     9 |   origin: '*',\n    10 |   credentials: true",
          "fix": {
            "recommendation": "Add Content-Security-Policy header using helmet middleware.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n  }\n}));\n",
            "before": "app.use(cors({",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#content-security-policy",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-content-security-policy-1762722082612-i3nod9rns",
          "rule": "missing-content-security-policy",
          "severity": "high",
          "category": "web-security",
          "title": "Missing Content-Security-Policy Header",
          "description": "CSP header missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/cors.js",
            "line": 6,
            "column": 12
          },
          "snippet": "     4 | const express = require('express');\n     5 | const cors = require('cors');\n→    6 | const app = express();\n     7 | \n     8 | app.use(cors({",
          "fix": {
            "recommendation": "Add Content-Security-Policy header using helmet middleware.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n  }\n}));\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#content-security-policy",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-x-frame-options-1762722082612-3538os8al",
          "rule": "missing-x-frame-options",
          "severity": "medium",
          "category": "web-security",
          "title": "Missing X-Frame-Options Header",
          "description": "Missing protection against clickjacking attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/cors.js",
            "line": 8,
            "column": 0
          },
          "snippet": "     6 | const app = express();\n     7 | \n→    8 | app.use(cors({\n     9 |   origin: '*',\n    10 |   credentials: true",
          "fix": {
            "recommendation": "Add X-Frame-Options header to prevent clickjacking.\n\nBefore (Express):\nconst app = express();\n\nAfter (Express):\napp.use(helmet.frameguard({ action: 'deny' }));\n// Or: app.use((req, res, next) => {\n//   res.setHeader('X-Frame-Options', 'DENY');\n//   next();\n// });\n\nBefore (Flask):\n@app.route('/')\ndef index():\n    return render_template('index.html')\n\nAfter (Flask):\n@app.after_request\ndef set_security_headers(response):\n    response.headers['X-Frame-Options'] = 'DENY'\n    return response\n",
            "before": "app.use(cors({",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#x-frame-options",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-1021",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-x-content-type-options-1762722082613-esbf92s0y",
          "rule": "missing-x-content-type-options",
          "severity": "low",
          "category": "web-security",
          "title": "Missing X-Content-Type-Options Header",
          "description": "Missing protection against MIME type sniffing attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/cors.js",
            "line": 14,
            "column": 2
          },
          "snippet": "    12 | \n    13 | app.get('/api/data', (req, res) => {\n→   14 |   res.json({ secret: 'data' });\n    15 | });\n    16 | ",
          "fix": {
            "recommendation": "Add X-Content-Type-Options header to prevent MIME sniffing.\n\nBefore:\nres.send(html);\n\nAfter:\napp.use(helmet.noSniff());\n// Or: res.setHeader('X-Content-Type-Options', 'nosniff');\nres.send(html);\n",
            "before": "res.json({ secret: 'data' });",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#x-content-type-options",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-430",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-referrer-policy-1762722082613-5wzfyhalz",
          "rule": "missing-referrer-policy",
          "severity": "low",
          "category": "web-security",
          "title": "Missing Referrer-Policy Header",
          "description": "Referrer header may leak sensitive information",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/cors.js",
            "line": 8,
            "column": 0
          },
          "snippet": "     6 | const app = express();\n     7 | \n→    8 | app.use(cors({\n     9 |   origin: '*',\n    10 |   credentials: true",
          "fix": {
            "recommendation": "Add Referrer-Policy header to control referrer information.\n\nBefore:\nconst app = express();\n\nAfter:\napp.use(helmet.referrerPolicy({ policy: 'strict-origin-when-cross-origin' }));\n// Or stricter: policy: 'no-referrer'\n",
            "before": "app.use(cors({",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#referrer-policy",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-200",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-permissions-policy-1762722082613-0ku3ykqa4",
          "rule": "missing-permissions-policy",
          "severity": "low",
          "category": "web-security",
          "title": "Missing Permissions-Policy Header",
          "description": "Permissions-Policy header missing, allowing unnecessary browser features",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/cors.js",
            "line": 8,
            "column": 0
          },
          "snippet": "     6 | const app = express();\n     7 | \n→    8 | app.use(cors({\n     9 |   origin: '*',\n    10 |   credentials: true",
          "fix": {
            "recommendation": "Add Permissions-Policy header to restrict browser features.\n\nBefore:\nconst app = express();\n\nAfter:\napp.use((req, res, next) => {\n  res.setHeader('Permissions-Policy',\n    'geolocation=(), camera=(), microphone=(), payment=()');\n  next();\n});\n",
            "before": "app.use(cors({",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#permissions-policy",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Permissions-Policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        }
      ]
    ],
    [
      "ef4f97505ed45e9c13a091e4e5751501b170d856",
      [
        {
          "id": "hardcoded-password-1762722082618-jeb1zzmaf",
          "rule": "hardcoded-password",
          "severity": "critical",
          "category": "secrets",
          "title": "Hardcoded Password Detected",
          "description": "Passwords should never be hardcoded in source code. Store them securely in environment variables or secure credential stores.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 26,
            "column": 3
          },
          "snippet": "    24 | # Issue 3: Placeholder credentials\n    25 | API_KEY = \"YOUR_API_KEY_HERE\"\n→   26 | DB_PASSWORD = \"changeme\"\n    27 | SECRET_TOKEN = \"placeholder-token\"\n    28 | ADMIN_USER = \"admin\"",
          "fix": {
            "recommendation": "Store passwords in environment variables (e.g., process.env.DB_PASSWORD) or use a secure credential management system",
            "before": "DB_PASSWORD = \"changeme\"",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "hardcoded-password-1762722082619-02heu47pe",
          "rule": "hardcoded-password",
          "severity": "critical",
          "category": "secrets",
          "title": "Hardcoded Password Detected",
          "description": "Passwords should never be hardcoded in source code. Store them securely in environment variables or secure credential stores.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 26,
            "column": 0
          },
          "snippet": "    24 | # Issue 3: Placeholder credentials\n    25 | API_KEY = \"YOUR_API_KEY_HERE\"\n→   26 | DB_PASSWORD = \"changeme\"\n    27 | SECRET_TOKEN = \"placeholder-token\"\n    28 | ADMIN_USER = \"admin\"",
          "fix": {
            "recommendation": "Store passwords in environment variables (e.g., process.env.DB_PASSWORD) or use a secure credential management system",
            "before": "DB_PASSWORD = \"changeme\"",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "security-todo-1762722082619-863tuaz88",
          "rule": "security-todo",
          "severity": "high",
          "category": "incomplete",
          "title": "Security TODO/FIXME Found",
          "description": "Incomplete security implementations leave systems vulnerable. TODOs in security code indicate unfinished protection mechanisms that attackers can exploit",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 10,
            "column": 2
          },
          "snippet": "     8 | \n     9 | # Issue 1: Security TODOs\n→   10 | # TODO: Add authentication middleware\n    11 | # TODO: Implement password validation\n    12 | def login(username, password):",
          "fix": {
            "recommendation": "Complete all security implementations before deploying to production\n\nBefore:\n// TODO: Add password validation\nfunction login(password) { ... }\n\nAfter:\nfunction login(password) {\n  if (!validatePassword(password)) {\n    throw new Error('Invalid password');\n  }\n  ...\n}\n",
            "before": "# TODO: Add authentication middleware",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-489",
            "owasp": "OWASP A4:2021"
          }
        },
        {
          "id": "security-todo-1762722082619-t6igyrnfr",
          "rule": "security-todo",
          "severity": "high",
          "category": "incomplete",
          "title": "Security TODO/FIXME Found",
          "description": "Incomplete security implementations leave systems vulnerable. TODOs in security code indicate unfinished protection mechanisms that attackers can exploit",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 11,
            "column": 2
          },
          "snippet": "     9 | # Issue 1: Security TODOs\n    10 | # TODO: Add authentication middleware\n→   11 | # TODO: Implement password validation\n    12 | def login(username, password):\n    13 |     # FIXME: Need to hash passwords before comparing",
          "fix": {
            "recommendation": "Complete all security implementations before deploying to production\n\nBefore:\n// TODO: Add password validation\nfunction login(password) { ... }\n\nAfter:\nfunction login(password) {\n  if (!validatePassword(password)) {\n    throw new Error('Invalid password');\n  }\n  ...\n}\n",
            "before": "# TODO: Implement password validation",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-489",
            "owasp": "OWASP A4:2021"
          }
        },
        {
          "id": "security-todo-1762722082619-9jg8t7dqd",
          "rule": "security-todo",
          "severity": "high",
          "category": "incomplete",
          "title": "Security TODO/FIXME Found",
          "description": "Incomplete security implementations leave systems vulnerable. TODOs in security code indicate unfinished protection mechanisms that attackers can exploit",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 13,
            "column": 6
          },
          "snippet": "    11 | # TODO: Implement password validation\n    12 | def login(username, password):\n→   13 |     # FIXME: Need to hash passwords before comparing\n    14 |     return authenticate_user(username, password)\n    15 | ",
          "fix": {
            "recommendation": "Complete all security implementations before deploying to production\n\nBefore:\n// TODO: Add password validation\nfunction login(password) { ... }\n\nAfter:\nfunction login(password) {\n  if (!validatePassword(password)) {\n    throw new Error('Invalid password');\n  }\n  ...\n}\n",
            "before": "# FIXME: Need to hash passwords before comparing",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-489",
            "owasp": "OWASP A4:2021"
          }
        },
        {
          "id": "security-todo-1762722082619-iotby1bcy",
          "rule": "security-todo",
          "severity": "high",
          "category": "incomplete",
          "title": "Security TODO/FIXME Found",
          "description": "Incomplete security implementations leave systems vulnerable. TODOs in security code indicate unfinished protection mechanisms that attackers can exploit",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 52,
            "column": 6
          },
          "snippet": "    50 | # More security TODOs\n    51 | def store_sensitive_data(data):\n→   52 |     # TODO: Add encryption before storing\n    53 |     # FIXME: Validate input data for security\n    54 |     return db.insert(data)",
          "fix": {
            "recommendation": "Complete all security implementations before deploying to production\n\nBefore:\n// TODO: Add password validation\nfunction login(password) { ... }\n\nAfter:\nfunction login(password) {\n  if (!validatePassword(password)) {\n    throw new Error('Invalid password');\n  }\n  ...\n}\n",
            "before": "# TODO: Add encryption before storing",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-489",
            "owasp": "OWASP A4:2021"
          }
        },
        {
          "id": "security-todo-1762722082619-57ang2jfq",
          "rule": "security-todo",
          "severity": "high",
          "category": "incomplete",
          "title": "Security TODO/FIXME Found",
          "description": "Incomplete security implementations leave systems vulnerable. TODOs in security code indicate unfinished protection mechanisms that attackers can exploit",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 53,
            "column": 6
          },
          "snippet": "    51 | def store_sensitive_data(data):\n    52 |     # TODO: Add encryption before storing\n→   53 |     # FIXME: Validate input data for security\n    54 |     return db.insert(data)\n    55 | ",
          "fix": {
            "recommendation": "Complete all security implementations before deploying to production\n\nBefore:\n// TODO: Add password validation\nfunction login(password) { ... }\n\nAfter:\nfunction login(password) {\n  if (!validatePassword(password)) {\n    throw new Error('Invalid password');\n  }\n  ...\n}\n",
            "before": "# FIXME: Validate input data for security",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-489",
            "owasp": "OWASP A4:2021"
          }
        },
        {
          "id": "security-todo-1762722082619-aiqx6wyy7",
          "rule": "security-todo",
          "severity": "high",
          "category": "incomplete",
          "title": "Security TODO/FIXME Found",
          "description": "Incomplete security implementations leave systems vulnerable. TODOs in security code indicate unfinished protection mechanisms that attackers can exploit",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 50,
            "column": 7
          },
          "snippet": "    48 |         print(e)\n    49 | \n→   50 | # More security TODOs\n    51 | def store_sensitive_data(data):\n    52 |     # TODO: Add encryption before storing",
          "fix": {
            "recommendation": "Complete all security implementations before deploying to production\n\nBefore:\n// TODO: Add password validation\nfunction login(password) { ... }\n\nAfter:\nfunction login(password) {\n  if (!validatePassword(password)) {\n    throw new Error('Invalid password');\n  }\n  ...\n}\n",
            "before": "# More security TODOs",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-489",
            "owasp": "OWASP A4:2021"
          }
        },
        {
          "id": "security-todo-1762722082645-txg53csei",
          "rule": "security-todo",
          "severity": "high",
          "category": "incomplete",
          "title": "Security TODO/FIXME Found",
          "description": "Incomplete security implementations leave systems vulnerable. TODOs in security code indicate unfinished protection mechanisms that attackers can exploit",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 10,
            "column": 0
          },
          "snippet": "     8 | \n     9 | # Issue 1: Security TODOs\n→   10 | # TODO: Add authentication middleware\n    11 | # TODO: Implement password validation\n    12 | def login(username, password):",
          "fix": {
            "recommendation": "Complete all security implementations before deploying to production\n\nBefore:\n// TODO: Add password validation\nfunction login(password) { ... }\n\nAfter:\nfunction login(password) {\n  if (!validatePassword(password)) {\n    throw new Error('Invalid password');\n  }\n  ...\n}\n",
            "before": "# TODO: Add authentication middleware",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-489",
            "owasp": "OWASP A4:2021"
          }
        },
        {
          "id": "security-todo-1762722082645-xk7cb5udl",
          "rule": "security-todo",
          "severity": "high",
          "category": "incomplete",
          "title": "Security TODO/FIXME Found",
          "description": "Incomplete security implementations leave systems vulnerable. TODOs in security code indicate unfinished protection mechanisms that attackers can exploit",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 11,
            "column": 0
          },
          "snippet": "     9 | # Issue 1: Security TODOs\n    10 | # TODO: Add authentication middleware\n→   11 | # TODO: Implement password validation\n    12 | def login(username, password):\n    13 |     # FIXME: Need to hash passwords before comparing",
          "fix": {
            "recommendation": "Complete all security implementations before deploying to production\n\nBefore:\n// TODO: Add password validation\nfunction login(password) { ... }\n\nAfter:\nfunction login(password) {\n  if (!validatePassword(password)) {\n    throw new Error('Invalid password');\n  }\n  ...\n}\n",
            "before": "# TODO: Implement password validation",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-489",
            "owasp": "OWASP A4:2021"
          }
        },
        {
          "id": "commented-security-check-1762722082665-oovng4uef",
          "rule": "commented-security-check",
          "severity": "critical",
          "category": "incomplete",
          "title": "Commented Out Security Check",
          "description": "Commented-out security checks disable critical protections, allowing unauthorized access or malicious input to pass through unchecked",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 18,
            "column": 4
          },
          "snippet": "    16 | # Issue 2: Commented out security validation\n    17 | def delete_resource(resource_id, user):\n→   18 |     # if not user.has_permission('delete'):\n    19 |     #     return {'error': 'Forbidden'}, 403\n    20 |     ",
          "fix": {
            "recommendation": "Re-enable all security checks. Never comment out validation or authentication logic\n\nBefore:\n// if (!user.hasPermission('admin')) { return forbidden(); }\ndangerousAction();\n\nAfter:\nif (!user.hasPermission('admin')) { \n  return forbidden(); \n}\ndangerousAction();\n",
            "before": "# if not user.has_permission('delete'):",
            "after": "",
            "references": [
              "https://cwe.mitre.org/data/definitions/489.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-489",
            "owasp": "OWASP A4:2021"
          }
        },
        {
          "id": "missing-csrf-flask-1762722082743-wn24haioh",
          "rule": "missing-csrf-flask",
          "severity": "high",
          "category": "web-security",
          "title": "Missing CSRF Protection (Flask)",
          "description": "Flask application without CSRF protection enabled",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 57,
            "column": 0
          },
          "snippet": "    55 | \n    56 | # Commented out authorization check\n→   57 | @app.route('/admin/delete', methods=['POST'])\n    58 | def admin_delete():\n    59 |     # if not request.user.is_admin:",
          "fix": {
            "recommendation": "Enable Flask-WTF CSRF protection.\n\nBefore:\nfrom flask import Flask\napp = Flask(__name__)\n\n@app.route('/transfer', methods=['POST'])\ndef transfer():\n    pass\n\nAfter:\nfrom flask import Flask\nfrom flask_wtf.csrf import CSRFProtect\n\napp = Flask(__name__)\napp.config['SECRET_KEY'] = os.environ.get('SECRET_KEY')\ncsrf = CSRFProtect(app)\n\n@app.route('/transfer', methods=['POST'])\ndef transfer():\n    pass  # CSRF automatically validated\n",
            "before": "@app.route('/admin/delete', methods=['POST'])",
            "after": "",
            "references": [
              "https://flask-wtf.readthedocs.io/en/stable/csrf.html",
              "https://cwe.mitre.org/data/definitions/352.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-352",
            "owasp": "A01:2021"
          }
        },
        {
          "id": "missing-csrf-flask-1762722082743-f7xm8ishx",
          "rule": "missing-csrf-flask",
          "severity": "high",
          "category": "web-security",
          "title": "Missing CSRF Protection (Flask)",
          "description": "Flask application without CSRF protection enabled",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 4,
            "column": 0
          },
          "snippet": "     2 | # Should trigger: security-todo, commented-security-check, placeholder-credentials, incomplete-error-handling\n     3 | \n→    4 | from flask import Flask, request, jsonify\n     5 | import jwt\n     6 | ",
          "fix": {
            "recommendation": "Enable Flask-WTF CSRF protection.\n\nBefore:\nfrom flask import Flask\napp = Flask(__name__)\n\n@app.route('/transfer', methods=['POST'])\ndef transfer():\n    pass\n\nAfter:\nfrom flask import Flask\nfrom flask_wtf.csrf import CSRFProtect\n\napp = Flask(__name__)\napp.config['SECRET_KEY'] = os.environ.get('SECRET_KEY')\ncsrf = CSRFProtect(app)\n\n@app.route('/transfer', methods=['POST'])\ndef transfer():\n    pass  # CSRF automatically validated\n",
            "before": "from flask import Flask, request, jsonify",
            "after": "",
            "references": [
              "https://flask-wtf.readthedocs.io/en/stable/csrf.html",
              "https://cwe.mitre.org/data/definitions/352.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-352",
            "owasp": "A01:2021"
          }
        },
        {
          "id": "debug-mode-enabled-1762722082745-33xjqdyno",
          "rule": "debug-mode-enabled",
          "severity": "critical",
          "category": "ai-specific",
          "title": "Debug Mode Enabled in Production",
          "description": "Debug mode exposes detailed error messages, enables hot-reloading, disables security features, and may leak sensitive configuration",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 66,
            "column": 4
          },
          "snippet": "    64 | \n    65 | if __name__ == '__main__':\n→   66 |     app.run(debug=True)\n    67 | ",
          "fix": {
            "recommendation": "Always disable debug mode in production\n\nBefore:\napp.run(debug=True)\n// OR\nconst app = express();\napp.use(morgan('dev'));\n\nAfter:\nconst isProduction = process.env.NODE_ENV === 'production';\napp.run(debug=!isProduction)\n\n// OR use environment variables\nif (process.env.NODE_ENV === 'production') {\n  app.use(morgan('combined'));\n}\n",
            "before": "app.run(debug=True)",
            "after": "",
            "references": [
              "https://flask.palletsprojects.com/en/2.0.x/config/#DEBUG",
              "https://expressjs.com/en/advanced/best-practice-performance.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-489",
            "owasp": "OWASP A6:2021"
          }
        },
        {
          "id": "hardcoded-password-1762722082788-okhsokg8f",
          "rule": "hardcoded-password",
          "severity": "critical",
          "category": "secrets",
          "title": "Hardcoded Password Detected",
          "description": "Passwords should never be hardcoded in source code. Store them securely in environment variables or secure credential stores.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 26,
            "column": 3
          },
          "snippet": "    24 | # Issue 3: Placeholder credentials\n    25 | API_KEY = \"YOUR_API_KEY_HERE\"\n→   26 | DB_PASSWORD = \"changeme\"\n    27 | SECRET_TOKEN = \"placeholder-token\"\n    28 | ADMIN_USER = \"admin\"",
          "fix": {
            "recommendation": "Store passwords in environment variables (e.g., process.env.DB_PASSWORD) or use a secure credential management system",
            "before": "DB_PASSWORD = \"changeme\"",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "hardcoded-password-1762722082788-i127o52yz",
          "rule": "hardcoded-password",
          "severity": "critical",
          "category": "secrets",
          "title": "Hardcoded Password Detected",
          "description": "Passwords should never be hardcoded in source code. Store them securely in environment variables or secure credential stores.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 26,
            "column": 0
          },
          "snippet": "    24 | # Issue 3: Placeholder credentials\n    25 | API_KEY = \"YOUR_API_KEY_HERE\"\n→   26 | DB_PASSWORD = \"changeme\"\n    27 | SECRET_TOKEN = \"placeholder-token\"\n    28 | ADMIN_USER = \"admin\"",
          "fix": {
            "recommendation": "Store passwords in environment variables (e.g., process.env.DB_PASSWORD) or use a secure credential management system",
            "before": "DB_PASSWORD = \"changeme\"",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "missing-x-frame-options-1762722082804-u8d7zbvz0",
          "rule": "missing-x-frame-options",
          "severity": "medium",
          "category": "web-security",
          "title": "Missing X-Frame-Options Header",
          "description": "Missing protection against clickjacking attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 7,
            "column": 6
          },
          "snippet": "     5 | import jwt\n     6 | \n→    7 | app = Flask(__name__)\n     8 | \n     9 | # Issue 1: Security TODOs",
          "fix": {
            "recommendation": "Add X-Frame-Options header to prevent clickjacking.\n\nBefore (Express):\nconst app = express();\n\nAfter (Express):\napp.use(helmet.frameguard({ action: 'deny' }));\n// Or: app.use((req, res, next) => {\n//   res.setHeader('X-Frame-Options', 'DENY');\n//   next();\n// });\n\nBefore (Flask):\n@app.route('/')\ndef index():\n    return render_template('index.html')\n\nAfter (Flask):\n@app.after_request\ndef set_security_headers(response):\n    response.headers['X-Frame-Options'] = 'DENY'\n    return response\n",
            "before": "app = Flask(__name__)",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#x-frame-options",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-1021",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-rate-limiting-1762722082808-oinovqnxl",
          "rule": "missing-rate-limiting",
          "severity": "critical",
          "category": "auth",
          "title": "Missing Rate Limiting on Authentication",
          "description": "Without rate limiting, attackers can attempt unlimited authentication attempts, enabling brute-force and credential stuffing attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 12,
            "column": 0
          },
          "snippet": "    10 | # TODO: Add authentication middleware\n    11 | # TODO: Implement password validation\n→   12 | def login(username, password):\n    13 |     # FIXME: Need to hash passwords before comparing\n    14 |     return authenticate_user(username, password)",
          "fix": {
            "recommendation": "Implement rate limiting on authentication endpoints using middleware or decorators\n\nBefore:\napp.post('/login', async (req, res) => {\n  const user = await authenticate(req.body);\n});\n\nAfter:\nconst rateLimit = require('express-rate-limit');\nconst loginLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000, // 15 minutes\n  max: 5, // limit each IP to 5 requests per windowMs\n  message: 'Too many login attempts, please try again later'\n});\n\napp.post('/login', loginLimiter, async (req, res) => {\n  const user = await authenticate(req.body);\n});\n",
            "before": "def login(username, password):",
            "after": "",
            "references": [
              "https://owasp.org/www-community/controls/Blocking_Brute_Force_Attacks",
              "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-307",
            "owasp": "OWASP A7:2021"
          }
        },
        {
          "id": "missing-rate-limiting-1762722082808-bhhayy29b",
          "rule": "missing-rate-limiting",
          "severity": "critical",
          "category": "auth",
          "title": "Missing Rate Limiting on Authentication",
          "description": "Without rate limiting, attackers can attempt unlimited authentication attempts, enabling brute-force and credential stuffing attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 43,
            "column": 0
          },
          "snippet": "    41 | \n    42 | # Another incomplete error handler\n→   43 | def authenticate(credentials):\n    44 |     try:\n    45 |         return check_credentials(credentials)",
          "fix": {
            "recommendation": "Implement rate limiting on authentication endpoints using middleware or decorators\n\nBefore:\napp.post('/login', async (req, res) => {\n  const user = await authenticate(req.body);\n});\n\nAfter:\nconst rateLimit = require('express-rate-limit');\nconst loginLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000, // 15 minutes\n  max: 5, // limit each IP to 5 requests per windowMs\n  message: 'Too many login attempts, please try again later'\n});\n\napp.post('/login', loginLimiter, async (req, res) => {\n  const user = await authenticate(req.body);\n});\n",
            "before": "def authenticate(credentials):",
            "after": "",
            "references": [
              "https://owasp.org/www-community/controls/Blocking_Brute_Force_Attacks",
              "https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-307",
            "owasp": "OWASP A7:2021"
          }
        },
        {
          "id": "missing-jwt-verification-1762722082809-rfbdxayd2",
          "rule": "missing-jwt-verification",
          "severity": "critical",
          "category": "auth",
          "title": "JWT Token Used Without Verification",
          "description": "Unverified JWT tokens can be forged by attackers, allowing authentication bypass and privilege escalation",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/incomplete-security.py",
            "line": 37,
            "column": 18
          },
          "snippet": "    35 | def verify_token(token):\n    36 |     try:\n→   37 |         decoded = jwt.decode(token, JWT_SECRET, algorithms=['HS256'])\n    38 |         return decoded\n    39 |     except Exception:",
          "fix": {
            "recommendation": "Always verify JWT signatures and validate claims\n\nBefore:\nconst decoded = jwt.decode(token);\n// OR\ndecoded = jwt.decode(token, verify=False)\n\nAfter:\nconst decoded = jwt.verify(token, SECRET_KEY, {\n  algorithms: ['HS256'],\n  issuer: 'your-app',\n  audience: 'your-api'\n});\n\nPython:\ndecoded = jwt.decode(\n  token, \n  SECRET_KEY, \n  algorithms=['HS256'],\n  verify=True,\n  audience='your-api'\n)\n",
            "before": "decoded = jwt.decode(token, JWT_SECRET, algorithms=['HS256'])",
            "after": "",
            "references": [
              "https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/",
              "https://cheatsheetseries.owasp.org/cheatsheets/JSON_Web_Token_for_Java_Cheat_Sheet.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-347",
            "owasp": "OWASP A2:2021"
          }
        }
      ]
    ],
    [
      "3bcccd0c1d2894cabcc876dfc4006a43205c0c21",
      [
        {
          "id": "missing-csrf-protection-1762722082816-2vbo5c309",
          "rule": "missing-csrf-protection",
          "severity": "high",
          "category": "web-security",
          "title": "Missing CSRF Protection",
          "description": "State-changing endpoints lack CSRF token validation",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
            "line": 42,
            "column": 0
          },
          "snippet": "    40 | \n    41 | // Another unprotected admin route\n→   42 | app.post('/admin/config', (req, res) => {\n    43 |   updateConfig(req.body);\n    44 |   res.json({ success: true });",
          "fix": {
            "recommendation": "Use CSRF protection middleware for state-changing requests.\n\nBefore:\napp.post('/transfer', (req, res) => {\n  // Transfer money\n});\n\nAfter:\nconst csrf = require('csurf');\nconst csrfProtection = csrf({ cookie: true });\n\napp.post('/transfer', csrfProtection, (req, res) => {\n  // CSRF token validated automatically\n});\n\n// In your form:\n// <input type=\"hidden\" name=\"_csrf\" value=\"<%= csrfToken %>\">\n",
            "before": "app.post('/admin/config', (req, res) => {",
            "after": "",
            "references": [
              "https://owasp.org/www-community/attacks/csrf",
              "https://cwe.mitre.org/data/definitions/352.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-352",
            "owasp": "A01:2021"
          }
        },
        {
          "id": "permissive-cors-1762722082816-07p6jogrr",
          "rule": "permissive-cors",
          "severity": "high",
          "category": "ai-specific",
          "title": "Overly Permissive CORS Configuration",
          "description": "Allowing all origins enables any website to make requests to your API, potentially exposing sensitive data or enabling CSRF attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
            "line": 20,
            "column": 17
          },
          "snippet": "    18 | // Alternative CORS vulnerability\n    19 | app.use((req, res, next) => {\n→   20 |   res.setHeader('Access-Control-Allow-Origin', '*');\n    21 |   res.setHeader('Access-Control-Allow-Methods', '*');\n    22 |   next();",
          "fix": {
            "recommendation": "Restrict CORS to specific trusted origins\n\nBefore:\nres.setHeader('Access-Control-Allow-Origin', '*');\n// OR\napp.use(cors({ origin: '*' }));\n\nAfter:\nconst allowedOrigins = ['https://app.example.com', 'https://admin.example.com'];\napp.use(cors({\n  origin: (origin, callback) => {\n    if (!origin || allowedOrigins.includes(origin)) {\n      callback(null, true);\n    } else {\n      callback(new Error('Not allowed by CORS'));\n    }\n  }\n}));\n",
            "before": "res.setHeader('Access-Control-Allow-Origin', '*');",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS",
              "https://owasp.org/www-community/attacks/CORS_OriginHeaderScrutiny"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-942",
            "owasp": "OWASP A5:2021"
          }
        },
        {
          "id": "verbose-error-response-1762722082817-c78omgdae",
          "rule": "verbose-error-response",
          "severity": "high",
          "category": "ai-specific",
          "title": "Verbose Error Messages Expose System Details",
          "description": "Exposing stack traces and error details reveals system architecture, file paths, and dependencies, helping attackers plan targeted attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
            "line": 58,
            "column": 4
          },
          "snippet": "    56 |     res.json({ success: true });\n    57 |   } catch (err) {\n→   58 |     res.send(err.stack); // Another verbose error\n    59 |   }\n    60 | });",
          "fix": {
            "recommendation": "Log detailed errors server-side, return generic messages to clients\n\nBefore:\napp.use((err, req, res, next) => {\n  res.status(500).json({ error: err.stack });\n});\n\nAfter:\napp.use((err, req, res, next) => {\n  logger.error('Server error', { \n    error: err.message, \n    stack: err.stack,\n    path: req.path \n  });\n  \n  res.status(500).json({ \n    error: 'Internal server error',\n    requestId: req.id // for support reference\n  });\n});\n",
            "before": "res.send(err.stack); // Another verbose error",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/209.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-209",
            "owasp": "OWASP A3:2017"
          }
        },
        {
          "id": "debug-mode-enabled-1762722082818-pb1ny3rqv",
          "rule": "debug-mode-enabled",
          "severity": "critical",
          "category": "ai-specific",
          "title": "Debug Mode Enabled in Production",
          "description": "Debug mode exposes detailed error messages, enables hot-reloading, disables security features, and may leak sensitive configuration",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
            "line": 16,
            "column": 0
          },
          "snippet": "    14 | \n    15 | // VULNERABILITY 2: Debug mode enabled (debug-mode-enabled)\n→   16 | app.use(morgan('dev'));\n    17 | \n    18 | // Alternative CORS vulnerability",
          "fix": {
            "recommendation": "Always disable debug mode in production\n\nBefore:\napp.run(debug=True)\n// OR\nconst app = express();\napp.use(morgan('dev'));\n\nAfter:\nconst isProduction = process.env.NODE_ENV === 'production';\napp.run(debug=!isProduction)\n\n// OR use environment variables\nif (process.env.NODE_ENV === 'production') {\n  app.use(morgan('combined'));\n}\n",
            "before": "app.use(morgan('dev'));",
            "after": "",
            "references": [
              "https://flask.palletsprojects.com/en/2.0.x/config/#DEBUG",
              "https://expressjs.com/en/advanced/best-practice-performance.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-489",
            "owasp": "OWASP A6:2021"
          }
        },
        {
          "id": "exposed-admin-endpoint-1762722082818-guhrthq2r",
          "rule": "exposed-admin-endpoint",
          "severity": "critical",
          "category": "ai-specific",
          "title": "Admin Endpoint Without Authentication",
          "description": "Unauthenticated admin endpoints allow anyone to access administrative functions, leading to complete system compromise",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
            "line": 48,
            "column": 0
          },
          "snippet": "    46 | \n    47 | // Unprotected dashboard\n→   48 | app.get('/dashboard', (req, res) => {\n    49 |   res.json({ stats: getSystemStats() });\n    50 | });",
          "fix": {
            "recommendation": "Always protect admin routes with authentication middleware\n\nBefore:\napp.get('/admin/users', (req, res) => {\n  res.json(await User.findAll());\n});\n\nAfter:\nconst requireAdmin = (req, res, next) => {\n  if (!req.user || !req.user.isAdmin) {\n    return res.status(403).json({ error: 'Forbidden' });\n  }\n  next();\n};\n\napp.get('/admin/users', requireAuth, requireAdmin, (req, res) => {\n  res.json(await User.findAll());\n});\n",
            "before": "app.get('/dashboard', (req, res) => {",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control",
              "https://cwe.mitre.org/data/definitions/306.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-306",
            "owasp": "OWASP A1:2021"
          }
        },
        {
          "id": "missing-csp-header-1762722082821-j4kszpdfh",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
            "line": 10,
            "column": 0
          },
          "snippet": "     8 | \n     9 | // VULNERABILITY 1: Overly permissive CORS (permissive-cors)\n→   10 | app.use(cors({\n    11 |   origin: '*',\n    12 |   credentials: true",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "app.use(cors({",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-csp-header-1762722082821-ohde3qpvy",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
            "line": 16,
            "column": 0
          },
          "snippet": "    14 | \n    15 | // VULNERABILITY 2: Debug mode enabled (debug-mode-enabled)\n→   16 | app.use(morgan('dev'));\n    17 | \n    18 | // Alternative CORS vulnerability",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "app.use(morgan('dev'));",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-csp-header-1762722082821-j7jbhjzh6",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
            "line": 19,
            "column": 0
          },
          "snippet": "    17 | \n    18 | // Alternative CORS vulnerability\n→   19 | app.use((req, res, next) => {\n    20 |   res.setHeader('Access-Control-Allow-Origin', '*');\n    21 |   res.setHeader('Access-Control-Allow-Methods', '*');",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "app.use((req, res, next) => {",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-csp-header-1762722082821-11gdaujke",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
            "line": 26,
            "column": 0
          },
          "snippet": "    24 | \n    25 | // VULNERABILITY 3: Verbose error responses (verbose-error-response)\n→   26 | app.use((err, req, res, next) => {\n    27 |   console.error('Error occurred:', err.stack);\n    28 |   res.status(500).json({",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "app.use((err, req, res, next) => {",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-csp-header-1762722082821-947mmvi1y",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
            "line": 36,
            "column": 0
          },
          "snippet": "    34 | \n    35 | // VULNERABILITY 4: Exposed admin endpoint (exposed-admin-endpoint)\n→   36 | app.get('/admin/users', async (req, res) => {\n    37 |   const users = await db.getAllUsers();\n    38 |   res.json(users);",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "app.get('/admin/users', async (req, res) => {",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-csp-header-1762722082821-yg0el1gde",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
            "line": 42,
            "column": 0
          },
          "snippet": "    40 | \n    41 | // Another unprotected admin route\n→   42 | app.post('/admin/config', (req, res) => {\n    43 |   updateConfig(req.body);\n    44 |   res.json({ success: true });",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "app.post('/admin/config', (req, res) => {",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-csp-header-1762722082821-c2tfk33yk",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
            "line": 48,
            "column": 0
          },
          "snippet": "    46 | \n    47 | // Unprotected dashboard\n→   48 | app.get('/dashboard', (req, res) => {\n    49 |   res.json({ stats: getSystemStats() });\n    50 | });",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "app.get('/dashboard', (req, res) => {",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-csp-header-1762722082821-i72fz5679",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
            "line": 53,
            "column": 0
          },
          "snippet": "    51 | \n    52 | // Error handler that exposes internals\n→   53 | app.get('/api/process', (req, res) => {\n    54 |   try {\n    55 |     processData(req.query.input);",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "app.get('/api/process', (req, res) => {",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-csp-header-1762722082821-a605kub9x",
          "rule": "missing-csp-header",
          "severity": "high",
          "category": "headers",
          "title": "Missing Content Security Policy",
          "description": "Content-Security-Policy header is missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
            "line": 7,
            "column": 12
          },
          "snippet": "     5 | const cors = require('cors');\n     6 | const morgan = require('morgan');\n→    7 | const app = express();\n     8 | \n     9 | // VULNERABILITY 1: Overly permissive CORS (permissive-cors)",
          "fix": {
            "recommendation": "Implement Content-Security-Policy header using helmet or manually.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\nconst app = express();\n\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n    connectSrc: [\"'self'\"],\n    fontSrc: [\"'self'\"],\n    objectSrc: [\"'none'\"],\n    mediaSrc: [\"'self'\"],\n    frameSrc: [\"'none'\"]\n  }\n}));\n\n// Or manually:\napp.use((req, res, next) => {\n  res.setHeader(\n    'Content-Security-Policy',\n    \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\"\n  );\n  next();\n});\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",
              "https://owasp.org/www-project-secure-headers/#content-security-policy"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-content-security-policy-1762722082825-zp44ijfre",
          "rule": "missing-content-security-policy",
          "severity": "high",
          "category": "web-security",
          "title": "Missing Content-Security-Policy Header",
          "description": "CSP header missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
            "line": 10,
            "column": 0
          },
          "snippet": "     8 | \n     9 | // VULNERABILITY 1: Overly permissive CORS (permissive-cors)\n→   10 | app.use(cors({\n    11 |   origin: '*',\n    12 |   credentials: true",
          "fix": {
            "recommendation": "Add Content-Security-Policy header using helmet middleware.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n  }\n}));\n",
            "before": "app.use(cors({",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#content-security-policy",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-content-security-policy-1762722082825-swaoddvnb",
          "rule": "missing-content-security-policy",
          "severity": "high",
          "category": "web-security",
          "title": "Missing Content-Security-Policy Header",
          "description": "CSP header missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
            "line": 16,
            "column": 0
          },
          "snippet": "    14 | \n    15 | // VULNERABILITY 2: Debug mode enabled (debug-mode-enabled)\n→   16 | app.use(morgan('dev'));\n    17 | \n    18 | // Alternative CORS vulnerability",
          "fix": {
            "recommendation": "Add Content-Security-Policy header using helmet middleware.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n  }\n}));\n",
            "before": "app.use(morgan('dev'));",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#content-security-policy",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-content-security-policy-1762722082825-0ktb0oqt7",
          "rule": "missing-content-security-policy",
          "severity": "high",
          "category": "web-security",
          "title": "Missing Content-Security-Policy Header",
          "description": "CSP header missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
            "line": 19,
            "column": 0
          },
          "snippet": "    17 | \n    18 | // Alternative CORS vulnerability\n→   19 | app.use((req, res, next) => {\n    20 |   res.setHeader('Access-Control-Allow-Origin', '*');\n    21 |   res.setHeader('Access-Control-Allow-Methods', '*');",
          "fix": {
            "recommendation": "Add Content-Security-Policy header using helmet middleware.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n  }\n}));\n",
            "before": "app.use((req, res, next) => {",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#content-security-policy",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-content-security-policy-1762722082825-ewe94594e",
          "rule": "missing-content-security-policy",
          "severity": "high",
          "category": "web-security",
          "title": "Missing Content-Security-Policy Header",
          "description": "CSP header missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
            "line": 26,
            "column": 0
          },
          "snippet": "    24 | \n    25 | // VULNERABILITY 3: Verbose error responses (verbose-error-response)\n→   26 | app.use((err, req, res, next) => {\n    27 |   console.error('Error occurred:', err.stack);\n    28 |   res.status(500).json({",
          "fix": {
            "recommendation": "Add Content-Security-Policy header using helmet middleware.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n  }\n}));\n",
            "before": "app.use((err, req, res, next) => {",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#content-security-policy",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        },
        {
          "id": "missing-content-security-policy-1762722082825-fb4qoibdt",
          "rule": "missing-content-security-policy",
          "severity": "high",
          "category": "web-security",
          "title": "Missing Content-Security-Policy Header",
          "description": "CSP header missing, allowing XSS and data injection attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/js/ai-security.js",
            "line": 7,
            "column": 12
          },
          "snippet": "     5 | const cors = require('cors');\n     6 | const morgan = require('morgan');\n→    7 | const app = express();\n     8 | \n     9 | // VULNERABILITY 1: Overly permissive CORS (permissive-cors)",
          "fix": {
            "recommendation": "Add Content-Security-Policy header using helmet middleware.\n\nBefore:\nconst app = express();\n\nAfter:\nconst helmet = require('helmet');\napp.use(helmet.contentSecurityPolicy({\n  directives: {\n    defaultSrc: [\"'self'\"],\n    scriptSrc: [\"'self'\"],\n    styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n    imgSrc: [\"'self'\", \"data:\", \"https:\"],\n  }\n}));\n",
            "before": "const app = express();",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#content-security-policy",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-693",
            "owasp": "A05:2021"
          }
        }
      ]
    ],
    [
      "a56c36c2a40865450b4d4874305df405b601f2a6",
      [
        {
          "id": "hardcoded-password-1762722082829-rl5wrugrr",
          "rule": "hardcoded-password",
          "severity": "critical",
          "category": "secrets",
          "title": "Hardcoded Password Detected",
          "description": "Passwords should never be hardcoded in source code. Store them securely in environment variables or secure credential stores.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/hardcoded-creds.py",
            "line": 5,
            "column": 3
          },
          "snippet": "     3 | # Note: These are FAKE credentials for testing purposes only\n     4 | \n→    5 | DB_PASSWORD = \"postgres123\"\n     6 | API_SECRET = \"fake_stripe_test_key_1234567890EXAMPLE\"\n     7 | AWS_ACCESS_KEY_ID = \"AKIAIOSFODNN7EXAMPLE\"",
          "fix": {
            "recommendation": "Store passwords in environment variables (e.g., process.env.DB_PASSWORD) or use a secure credential management system",
            "before": "DB_PASSWORD = \"postgres123\"",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "hardcoded-password-1762722082829-gqpcu9o7a",
          "rule": "hardcoded-password",
          "severity": "critical",
          "category": "secrets",
          "title": "Hardcoded Password Detected",
          "description": "Passwords should never be hardcoded in source code. Store them securely in environment variables or secure credential stores.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/hardcoded-creds.py",
            "line": 5,
            "column": 0
          },
          "snippet": "     3 | # Note: These are FAKE credentials for testing purposes only\n     4 | \n→    5 | DB_PASSWORD = \"postgres123\"\n     6 | API_SECRET = \"fake_stripe_test_key_1234567890EXAMPLE\"\n     7 | AWS_ACCESS_KEY_ID = \"AKIAIOSFODNN7EXAMPLE\"",
          "fix": {
            "recommendation": "Store passwords in environment variables (e.g., process.env.DB_PASSWORD) or use a secure credential management system",
            "before": "DB_PASSWORD = \"postgres123\"",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "aws-credentials-1762722082829-o5l2gk3mv",
          "rule": "aws-credentials",
          "severity": "critical",
          "category": "secrets",
          "title": "AWS Credentials Detected",
          "description": "AWS credentials should never be hardcoded. Use IAM roles or environment variables.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/hardcoded-creds.py",
            "line": 7,
            "column": 21
          },
          "snippet": "     5 | DB_PASSWORD = \"postgres123\"\n     6 | API_SECRET = \"fake_stripe_test_key_1234567890EXAMPLE\"\n→    7 | AWS_ACCESS_KEY_ID = \"AKIAIOSFODNN7EXAMPLE\"\n     8 | AWS_SECRET_ACCESS_KEY = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n     9 | ",
          "fix": {
            "recommendation": "Use AWS IAM roles or store credentials in ~/.aws/credentials or environment variables",
            "before": "AWS_ACCESS_KEY_ID = \"AKIAIOSFODNN7EXAMPLE\"",
            "after": "",
            "references": [
              "https://docs.aws.amazon.com/general/latest/gr/aws-access-keys-best-practices.html",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "aws-credentials-1762722082829-gmluj2qdq",
          "rule": "aws-credentials",
          "severity": "critical",
          "category": "secrets",
          "title": "AWS Credentials Detected",
          "description": "AWS credentials should never be hardcoded. Use IAM roles or environment variables.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/hardcoded-creds.py",
            "line": 7,
            "column": 0
          },
          "snippet": "     5 | DB_PASSWORD = \"postgres123\"\n     6 | API_SECRET = \"fake_stripe_test_key_1234567890EXAMPLE\"\n→    7 | AWS_ACCESS_KEY_ID = \"AKIAIOSFODNN7EXAMPLE\"\n     8 | AWS_SECRET_ACCESS_KEY = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n     9 | ",
          "fix": {
            "recommendation": "Use AWS IAM roles or store credentials in ~/.aws/credentials or environment variables",
            "before": "AWS_ACCESS_KEY_ID = \"AKIAIOSFODNN7EXAMPLE\"",
            "after": "",
            "references": [
              "https://docs.aws.amazon.com/general/latest/gr/aws-access-keys-best-practices.html",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "aws-credentials-1762722082829-m31x39edy",
          "rule": "aws-credentials",
          "severity": "critical",
          "category": "secrets",
          "title": "AWS Credentials Detected",
          "description": "AWS credentials should never be hardcoded. Use IAM roles or environment variables.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/hardcoded-creds.py",
            "line": 8,
            "column": 0
          },
          "snippet": "     6 | API_SECRET = \"fake_stripe_test_key_1234567890EXAMPLE\"\n     7 | AWS_ACCESS_KEY_ID = \"AKIAIOSFODNN7EXAMPLE\"\n→    8 | AWS_SECRET_ACCESS_KEY = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n     9 | \n    10 | def connect_db():",
          "fix": {
            "recommendation": "Use AWS IAM roles or store credentials in ~/.aws/credentials or environment variables",
            "before": "AWS_SECRET_ACCESS_KEY = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"",
            "after": "",
            "references": [
              "https://docs.aws.amazon.com/general/latest/gr/aws-access-keys-best-practices.html",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "hardcoded-api-key-1762722082831-s93vgf8ja",
          "rule": "hardcoded-api-key",
          "severity": "critical",
          "category": "secrets",
          "title": "Hardcoded API Key Detected",
          "description": "API keys should be stored in environment variables, not hardcoded in source code. Exposed credentials can be used by attackers to access your API.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/hardcoded-creds.py",
            "line": 6,
            "column": 14
          },
          "snippet": "     4 | \n     5 | DB_PASSWORD = \"postgres123\"\n→    6 | API_SECRET = \"fake_stripe_test_key_1234567890EXAMPLE\"\n     7 | AWS_ACCESS_KEY_ID = \"AKIAIOSFODNN7EXAMPLE\"\n     8 | AWS_SECRET_ACCESS_KEY = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"",
          "fix": {
            "recommendation": "Move the API key to an environment variable using process.env or equivalent",
            "before": "API_SECRET = \"fake_stripe_test_key_1234567890EXAMPLE\"",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "hardcoded-password-1762722082831-d23nbx5z2",
          "rule": "hardcoded-password",
          "severity": "critical",
          "category": "secrets",
          "title": "Hardcoded Password Detected",
          "description": "Passwords should never be hardcoded in source code. Store them securely in environment variables or secure credential stores.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/hardcoded-creds.py",
            "line": 5,
            "column": 3
          },
          "snippet": "     3 | # Note: These are FAKE credentials for testing purposes only\n     4 | \n→    5 | DB_PASSWORD = \"postgres123\"\n     6 | API_SECRET = \"fake_stripe_test_key_1234567890EXAMPLE\"\n     7 | AWS_ACCESS_KEY_ID = \"AKIAIOSFODNN7EXAMPLE\"",
          "fix": {
            "recommendation": "Store passwords in environment variables (e.g., process.env.DB_PASSWORD) or use a secure credential management system",
            "before": "DB_PASSWORD = \"postgres123\"",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "hardcoded-password-1762722082831-o65tre6ip",
          "rule": "hardcoded-password",
          "severity": "critical",
          "category": "secrets",
          "title": "Hardcoded Password Detected",
          "description": "Passwords should never be hardcoded in source code. Store them securely in environment variables or secure credential stores.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/hardcoded-creds.py",
            "line": 5,
            "column": 0
          },
          "snippet": "     3 | # Note: These are FAKE credentials for testing purposes only\n     4 | \n→    5 | DB_PASSWORD = \"postgres123\"\n     6 | API_SECRET = \"fake_stripe_test_key_1234567890EXAMPLE\"\n     7 | AWS_ACCESS_KEY_ID = \"AKIAIOSFODNN7EXAMPLE\"",
          "fix": {
            "recommendation": "Store passwords in environment variables (e.g., process.env.DB_PASSWORD) or use a secure credential management system",
            "before": "DB_PASSWORD = \"postgres123\"",
            "after": "",
            "references": [
              "https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "aws-credentials-1762722082831-57f9h2f7h",
          "rule": "aws-credentials",
          "severity": "critical",
          "category": "secrets",
          "title": "AWS Credentials Detected",
          "description": "AWS credentials should never be hardcoded. Use IAM roles or environment variables.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/hardcoded-creds.py",
            "line": 7,
            "column": 21
          },
          "snippet": "     5 | DB_PASSWORD = \"postgres123\"\n     6 | API_SECRET = \"fake_stripe_test_key_1234567890EXAMPLE\"\n→    7 | AWS_ACCESS_KEY_ID = \"AKIAIOSFODNN7EXAMPLE\"\n     8 | AWS_SECRET_ACCESS_KEY = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n     9 | ",
          "fix": {
            "recommendation": "Use AWS IAM roles or store credentials in ~/.aws/credentials or environment variables",
            "before": "AWS_ACCESS_KEY_ID = \"AKIAIOSFODNN7EXAMPLE\"",
            "after": "",
            "references": [
              "https://docs.aws.amazon.com/general/latest/gr/aws-access-keys-best-practices.html",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "aws-credentials-1762722082831-kfvl3yfsi",
          "rule": "aws-credentials",
          "severity": "critical",
          "category": "secrets",
          "title": "AWS Credentials Detected",
          "description": "AWS credentials should never be hardcoded. Use IAM roles or environment variables.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/hardcoded-creds.py",
            "line": 7,
            "column": 0
          },
          "snippet": "     5 | DB_PASSWORD = \"postgres123\"\n     6 | API_SECRET = \"fake_stripe_test_key_1234567890EXAMPLE\"\n→    7 | AWS_ACCESS_KEY_ID = \"AKIAIOSFODNN7EXAMPLE\"\n     8 | AWS_SECRET_ACCESS_KEY = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n     9 | ",
          "fix": {
            "recommendation": "Use AWS IAM roles or store credentials in ~/.aws/credentials or environment variables",
            "before": "AWS_ACCESS_KEY_ID = \"AKIAIOSFODNN7EXAMPLE\"",
            "after": "",
            "references": [
              "https://docs.aws.amazon.com/general/latest/gr/aws-access-keys-best-practices.html",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        },
        {
          "id": "aws-credentials-1762722082831-3b6znlwqy",
          "rule": "aws-credentials",
          "severity": "critical",
          "category": "secrets",
          "title": "AWS Credentials Detected",
          "description": "AWS credentials should never be hardcoded. Use IAM roles or environment variables.",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/hardcoded-creds.py",
            "line": 8,
            "column": 0
          },
          "snippet": "     6 | API_SECRET = \"fake_stripe_test_key_1234567890EXAMPLE\"\n     7 | AWS_ACCESS_KEY_ID = \"AKIAIOSFODNN7EXAMPLE\"\n→    8 | AWS_SECRET_ACCESS_KEY = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n     9 | \n    10 | def connect_db():",
          "fix": {
            "recommendation": "Use AWS IAM roles or store credentials in ~/.aws/credentials or environment variables",
            "before": "AWS_SECRET_ACCESS_KEY = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"",
            "after": "",
            "references": [
              "https://docs.aws.amazon.com/general/latest/gr/aws-access-keys-best-practices.html",
              "https://cwe.mitre.org/data/definitions/798.html"
            ]
          },
          "metadata": {
            "confidence": 0.8999999999999999,
            "cwe": "CWE-798",
            "owasp": "A3:2017"
          }
        }
      ]
    ],
    [
      "5df22bcde64d854746697c53541dc121a72a85bf",
      [
        {
          "id": "missing-csrf-flask-1762722082873-xh5cifrmd",
          "rule": "missing-csrf-flask",
          "severity": "high",
          "category": "web-security",
          "title": "Missing CSRF Protection (Flask)",
          "description": "Flask application without CSRF protection enabled",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/sql-injection.py",
            "line": 4,
            "column": 0
          },
          "snippet": "     2 | # Should trigger: sql-injection\n     3 | \n→    4 | from flask import Flask, request\n     5 | import sqlite3\n     6 | ",
          "fix": {
            "recommendation": "Enable Flask-WTF CSRF protection.\n\nBefore:\nfrom flask import Flask\napp = Flask(__name__)\n\n@app.route('/transfer', methods=['POST'])\ndef transfer():\n    pass\n\nAfter:\nfrom flask import Flask\nfrom flask_wtf.csrf import CSRFProtect\n\napp = Flask(__name__)\napp.config['SECRET_KEY'] = os.environ.get('SECRET_KEY')\ncsrf = CSRFProtect(app)\n\n@app.route('/transfer', methods=['POST'])\ndef transfer():\n    pass  # CSRF automatically validated\n",
            "before": "from flask import Flask, request",
            "after": "",
            "references": [
              "https://flask-wtf.readthedocs.io/en/stable/csrf.html",
              "https://cwe.mitre.org/data/definitions/352.html"
            ]
          },
          "metadata": {
            "confidence": 0.7999999999999999,
            "cwe": "CWE-352",
            "owasp": "A01:2021"
          }
        },
        {
          "id": "missing-x-frame-options-1762722082877-gej4zp966",
          "rule": "missing-x-frame-options",
          "severity": "medium",
          "category": "web-security",
          "title": "Missing X-Frame-Options Header",
          "description": "Missing protection against clickjacking attacks",
          "location": {
            "file": "/Users/johnferguson/Github/vibesec/tests/fixtures/vulnerable/py/sql-injection.py",
            "line": 7,
            "column": 6
          },
          "snippet": "     5 | import sqlite3\n     6 | \n→    7 | app = Flask(__name__)\n     8 | \n     9 | @app.route('/user/<user_id>')",
          "fix": {
            "recommendation": "Add X-Frame-Options header to prevent clickjacking.\n\nBefore (Express):\nconst app = express();\n\nAfter (Express):\napp.use(helmet.frameguard({ action: 'deny' }));\n// Or: app.use((req, res, next) => {\n//   res.setHeader('X-Frame-Options', 'DENY');\n//   next();\n// });\n\nBefore (Flask):\n@app.route('/')\ndef index():\n    return render_template('index.html')\n\nAfter (Flask):\n@app.after_request\ndef set_security_headers(response):\n    response.headers['X-Frame-Options'] = 'DENY'\n    return response\n",
            "before": "app = Flask(__name__)",
            "after": "",
            "references": [
              "https://owasp.org/www-project-secure-headers/#x-frame-options",
              "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options"
            ]
          },
          "metadata": {
            "confidence": 0.7,
            "cwe": "CWE-1021",
            "owasp": "A05:2021"
          }
        }
      ]
    ],
    [
      "b884c44ba569c830f9cbaedb6a29f7f35cf87673",
      []
    ]
  ]
}